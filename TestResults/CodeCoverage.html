<!DOCTYPE html>
<html lang="en">
<head>
<title>Coverage</title>
<meta charset="utf-8"/>
<style>
@media screen{
    html {background-color: #FFFFF0;}
body {
    font-size: 16px;
    font-family : Verdana, "Bitstream Vera Sans", "DejaVu Sans", Tahoma, Geneva, Arial, Sans-serif;
    margin: 1em;
}
th, td {padding: 5px 10px;}
th {text-align: left;}
h1, h2, h3, h4, h5, h6 {color: #424242;}
h1 {font-size: 22px;}
h2 {font-size: 18px; margin-top: 2em; margin-bottom:0.3em;}
tbody tr:nth-child(even) {background-color: #F0F0F0;}
tbody tr:nth-child(odd) {background-color: #FAFAFA;}
th {background-color: #E6E6E6;color: #424242;}
table {border: silver 1px solid; font-size: 14px;font-family: APLFont, monospace;}
code , code a {font-size: 14px; font-family: APLFont, monospace;}
code.header {
    font-size: 16px; 
    font-family: APLFont, monospace; 
    margin: 1.5em 0.5em 0 0.5em; 
    padding:0;
    display: block;
}
div.code-block {
    border: 1px silver dashed;
    background-color: #F2F2F2;
    display: block;
    margin: 0.5em 0.5em 0.5em 0.5em;
    padding: 0.5em;
}
div.code-block.missing {
    background-color: #fa605254;
}
div.code-block code {display: block; white-space: pre-wrap; margin:0; padding:0; word-wrap: break-word;}
.emphasize { font-weight: 800;}
ul li, ol li {margin: 0.7em 0.2em;}
.float-right {float:right;}
.no-underline {    text-decoration :none;}
.top-links {font-size:20px; padding-left: 0.6em;}
.align-right {text-align: right;}
#footer hr {margin-top:1.5em;}
#footer p {margin-top:5px; padding-top:0; font-size: 9px;}
@font-face {
        font-family: "APLFont";
    src:
        local("APL385 Unicode"),
        url("https://misc.aplteam.com/apl385.ttf") format("truetype");
}
.info {border: 1px silver dashed; background-color: #F2F2F2;margin: 0.5em; padding: 0.5em;}
}
@media print{@page {size: portrait}
@page {
    margin: 1cm 1cm 1cm 1.75cm;
    @bottom-right {
        content: counter(page) " / " counter(pages);
  }
}
body {
    font: 12pt "Times New Roman", Times, serif;
    line-height: 1.2;
     /* CSS3 filter, at the moment Webkit only. Prefix it for future implementations */
    -webkit-filter: grayscale(100%);
    filter: grayscale(100%); /* future-proof */
}
h1 {font-size: 18pt;}
h2 {font-size: 16pt; margin-top: 10pt; margin-bottom: 3pt;}
th, td {padding: 2pt 3pt;}
th {text-align: left;background-color: #DBDBDB;}
tbody tr:nth-child(odd) {background-color: #EDEDED;}
table {
    color-adjust: exact !important;
    -webkit-print-color-adjust: exact !important;
    print-color-adjust: exact !important;
    font-size: 8pt;
    font-family: APLFont, monospace;
}
div.keep-together {break-inside: avoid; break-before:auto;}
table {border: silver 1pt solid;}
code , code a {font-size: 8pt; font-family: APLFont, monospace;}
code.header {
    font-size: 8pt;
    font-family: APLFont, monospace;
    margin: 7pt 3pt 0 10pt;
    padding:0;
    display: block;
}
div.code-block {
    border: 1pt silver dashed;
    background-color: #F2F2F2;
    display: block;
    margin: 4pt 4pt 4pt 4pt;
    padding: 4pt;
}
div.code-block code {display: block; white-space: pre-wrap; margin:0; padding:0; word-wrap: break-word;}
.emphasize { font-weight: 800;}
a {text-decoration: none;color: black;}
ul li, ol li {margin: 8pt 3pt;}
.no-print {display:none;}
.align-right {text-align: right;}
#footer hr {margin-top:1.5em;}
#footer p {margin-top:5pt; padding-top:0; font-size: 6pt;}
@font-face {
        font-family: "APLFont";
    src:
        local("APL385 Unicode"),
        url("https://misc.aplteam.com/apl385.ttf") format("truetype");
}
.info {border: 1px silver dashed; background-color: #F2F2F2;margin: 8px; padding: 8px;}
}
</style>
<link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/v/dt/jq-3.6.0/dt-1.11.2/b-2.0.0/b-print-2.0.0/fh-3.1.9/r-2.2.9/datatables.min.css"/>
<script type="text/javascript" src="https://cdn.datatables.net/v/dt/jq-3.6.0/dt-1.11.2/b-2.0.0/b-print-2.0.0/fh-3.1.9/r-2.2.9/datatables.min.js"></script>
</head>
<body>
<h1 id="top">Coverage Report</h1>
<p>Watched: 27 fns/opr within <code>#.Snippets.Snippets_UC</code></p>
<p>The test suite was executed once:</p>
<table>
<thead>
<tr><th>Executed at</th><th>APLVersion</th><th>Memory (MB)</th></tr>
</thead>
<tbody>
<tr><td>2023-07-08 19:20:09</td><td>Windows-64 ⋄ 18.2.47418.0 ⋄ W ⋄ Development ⋄ Unicode</td><td>53</td></tr>
</tbody>
</table>
<p>Overall 0% of the testable code is covered.</p>
<p>(Comment lines, empty lines, all <code>:End</code>* lines etc. are ignored)</p>
<p>2 of the fns/opr are 100% covered.</p>
<div id="partly-covered" class="keep-together">
<table id="percent">
<thead>
<tr><th style="text-align:left;">Function/Operator</th><th style="text-align:left;">Lines not executed</th><th style="text-align:left;">Coverage</th><th style="text-align:right;">≢</th></tr>
</thead>
<tbody>
<tr class="uncovered"><td><a href="#listing_1" title="Link to listing">#.Snippets.Snippets_UC.List</a></td><td>61←≢2,4-9,11-16,18-23,25-30,32-37,39-44,46-51,53-58,60-65,67-72</td><td>0</td><td>61</td></tr>
<tr class="uncovered"><td><a href="#listing_2" title="Link to listing">#.Snippets.Snippets_UC.Run</a></td><td>26←≢2-4,6-27,29</td><td>0</td><td>26</td></tr>
<tr class="uncovered"><td><a href="#listing_3" title="Link to listing">#.Snippets.Snippets_UC._</a></td><td>1</td><td>0</td><td>1</td></tr>
<tr class="uncovered"><td><a href="#listing_4" title="Link to listing">#.Snippets.Snippets_UC.Compare_</a></td><td>1</td><td>0</td><td>1</td></tr>
<tr class="uncovered"><td><a href="#listing_5" title="Link to listing">#.Snippets.Snippets_UC.Help_</a></td><td>1, 2</td><td>0</td><td>2</td></tr>
<tr class="uncovered"><td><a href="#listing_6" title="Link to listing">#.Snippets.Snippets_UC.Version_</a></td><td>1</td><td>0</td><td>1</td></tr>
<tr class="uncovered"><td><a href="#listing_7" title="Link to listing">#.Snippets.Snippets_UC.Edit_</a></td><td>13←≢1-12,14</td><td>0</td><td>13</td></tr>
<tr class="uncovered"><td><a href="#listing_8" title="Link to listing">#.Snippets.Snippets_UC.Save_</a></td><td>53←≢1-5,7-8,11-14,16-21,24-36,38,41-42,44-46,48-49,51-56,58,60-61,63-64,66-67,69-70</td><td>0</td><td>53</td></tr>
<tr class="uncovered"><td><a href="#listing_9" title="Link to listing">#.Snippets.Snippets_UC.Delete_</a></td><td>4←≢1-4</td><td>0</td><td>4</td></tr>
<tr class="uncovered"><td><a href="#listing_10" title="Link to listing">#.Snippets.Snippets_UC.Fix_</a></td><td>35←≢1-8,10,12,15,17-20,22-23,25-26,28-29,31-33,35,37-40,42,44,46-47,49,53</td><td>0</td><td>35</td></tr>
<tr class="uncovered"><td><a href="#listing_11" title="Link to listing">#.Snippets.Snippets_UC.Copy_</a></td><td>13←≢1-9,11,13-14,17</td><td>0</td><td>13</td></tr>
<tr class="uncovered"><td><a href="#listing_12" title="Link to listing">#.Snippets.Snippets_UC.List_</a></td><td>25←≢1-10,12,14,16-18,20,22-23,25-27,29-30,32-33</td><td>0</td><td>25</td></tr>
<tr class="uncovered"><td><a href="#listing_13" title="Link to listing">#.Snippets.Snippets_UC.View_</a></td><td>11←≢1-8,10-12</td><td>0</td><td>11</td></tr>
<tr class="uncovered"><td><a href="#listing_14" title="Link to listing">#.Snippets.Snippets_UC.Help</a></td><td>116←≢2-32,34-35,37-117,119-120</td><td>0</td><td>116</td></tr>
<tr class="uncovered"><td><a href="#listing_15" title="Link to listing">#.Snippets.Snippets_UC.GetNameAndFilename</a></td><td>19←≢6-15,17,20-21,25-26,29-31,33</td><td>0</td><td>19</td></tr>
<tr class="uncovered"><td><a href="#listing_16" title="Link to listing">#.Snippets.Snippets_UC.GetNameFromBody</a></td><td>1, 2, 4</td><td>0</td><td>3</td></tr>
<tr class="uncovered"><td><a href="#listing_17" title="Link to listing">#.Snippets.Snippets_UC.GetNameAndBody</a></td><td>1, 2, 3</td><td>0</td><td>3</td></tr>
<tr class="uncovered"><td><a href="#listing_18" title="Link to listing">#.Snippets.Snippets_UC.EstablishCodeInNamespace</a></td><td>4←≢1-3,5</td><td>0</td><td>4</td></tr>
<tr class="uncovered"><td><a href="#listing_19" title="Link to listing">#.Snippets.Snippets_UC.GetCodeFromWS</a></td><td>4←≢1-2,4-5</td><td>0</td><td>4</td></tr>
<tr class="uncovered"><td><a href="#listing_20" title="Link to listing">#.Snippets.Snippets_UC.GetCodeFromFile</a></td><td>6←≢1-5,7</td><td>0</td><td>6</td></tr>
<tr class="uncovered"><td><a href="#listing_21" title="Link to listing">#.Snippets.Snippets_UC.IsScripted</a></td><td>2, 3</td><td>0</td><td>2</td></tr>
<tr class="uncovered"><td><a href="#listing_22" title="Link to listing">#.Snippets.Snippets_UC.GetComment</a></td><td>9←≢1-5,7-9,11</td><td>0</td><td>9</td></tr>
<tr class="uncovered"><td><a href="#listing_23" title="Link to listing">#.Snippets.Snippets_UC.CutWidth</a></td><td>4←≢1-4</td><td>0</td><td>4</td></tr>
<tr class="uncovered"><td><a href="#listing_24" title="Link to listing">#.Snippets.Snippets_UC.GetHomeFolder</a></td><td>1, 2</td><td>0</td><td>2</td></tr>
<tr class="uncovered"><td><a href="#listing_25" title="Link to listing">#.Snippets.Snippets_UC.CollectSnippetInfo</a></td><td>31←≢1-6,8-9,11-12,14-17,19-22,24-25,27-30,32-33,37-40,42</td><td>0</td><td>31</td></tr>
<tr class="fullyCovered"><td><a href="#listing_26" title="Link to listing">#.Snippets.Snippets_UC.ref</a></td><td></td><td>100</td><td>0</td></tr>
<tr class="fullyCovered"><td><a href="#listing_27" title="Link to listing">#.Snippets.Snippets_UC.all</a></td><td></td><td>100</td><td>0</td></tr>
</tbody>
</table>
</div>
<script>
$(document).ready(function() {
    var oTable;
    oTable = $("#percent").DataTable( {
        paging:   false,
        ordering: true,
        info:     true,
        fixedHeader: true,
        order: [2,"asc"],
        dom: "Bft",
        drawCallback: function( settings ) {
             var api = this.api();
             $('.header[id^="listing_"]').next().addBack().css("display","none");
             api.rows( {page:"current"} ).data().each(function(data){
              id = data[0];
              id = id.match(/"(\#.*?)"/);
              if (id){$(id[1]).next().addBack().css("display","block");}
             })
        },      
        buttons: [
        {
            text: "Partly covered (0)",
            titleAttr: "50%",
            className: "active",
            action: function ( e, dt, node, config ) {
                var text = this.text();
                var search = "^(?!(0%|100%)).*";
                oTable.column(2)
                    .search(search,true,false,false)
                    .draw();
                $(".dt-buttons button").removeClass("active");
                this.active( true );
            }
        },
        {
            text: "Uncovered (25)",
            titleAttr: "0%",
            className: "active",
            action: function ( e, dt, node, config ) {
                var text = this.text();
                var search = "^0%";
                oTable.column(2)
                    .search(search,true,false,false)
                    .draw();
                $(".dt-buttons button").removeClass("active");
                this.active( true );
            }
        },
        {
            text: "Fully covered (2)",
            titleAttr: "100%",
            className: "active",
            action: function ( e, dt, node, config ) {
                var text = this.text();
                var search = "100%";
                oTable.column(2)
                    .search(search,true,false,false)
                    .draw();
                $(".dt-buttons button").removeClass("active");
                this.active( true );
            }
        },
        {
            text: "All (27)",
            titleAttr: "all",
            className: "active",
            action: function ( e, dt, node, config ) {
                var text = this.text();
                var search = ".";
                oTable.column(2)
                    .search(search,true,false,false)
                    .draw();
                $(".dt-buttons button").removeClass("active");
                this.active( true );
            }
        },
    ],
 
        columnDefs: [
            {className: "align-right", targets: [2,3]
            },
            {
                render: function ( data, type, row, meta ) {
                            return data+"%" ;        
                        },
                targets: 2
            }
        ]             
    } );
    oTable.button(0).trigger();

} );    
</script>
<h2>Listings</h2>
<code class="header" id="listing_1">#.Snippets.Snippets_UC.List &mdash; 0%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  r←List</code>
<code> [1]   :Access Shared Public</code>
<code class="emphasize">→[2]   r←⍬</code>
<code> [3]  </code>
<code class="emphasize">→[4]   c←⎕NS''</code>
<code class="emphasize">→[5]   c.Name←'List'</code>
<code class="emphasize">→[6]   c.Desc←'List all saved snippets'</code>
<code class="emphasize">→[7]   c.Group←'Snippets'</code>
<code class="emphasize">→[8]   c.Parse←'1s -short -full'</code>
<code class="emphasize">→[9]   r,←c</code>
<code> [10] </code>
<code class="emphasize">→[11]  c←⎕NS''</code>
<code class="emphasize">→[12]  c.Name←'Edit'</code>
<code class="emphasize">→[13]  c.Desc←'Edit a snippet'</code>
<code class="emphasize">→[14]  c.Group←'Snippets'</code>
<code class="emphasize">→[15]  c.Parse←'1s'</code>
<code class="emphasize">→[16]  r,←c</code>
<code> [17] </code>
<code class="emphasize">→[18]  c←⎕NS''</code>
<code class="emphasize">→[19]  c.Name←'Copy'</code>
<code class="emphasize">→[20]  c.Desc←'Copy a snippet to the clipboard (Windows only)'</code>
<code class="emphasize">→[21]  c.Group←'Snippets'</code>
<code class="emphasize">→[22]  c.Parse←'1s'</code>
<code class="emphasize">→[23]  r,←c</code>
<code> [24] </code>
<code class="emphasize">→[25]  c←⎕NS''</code>
<code class="emphasize">→[26]  c.Name←'Fix'</code>
<code class="emphasize">→[27]  c.Desc←'Fix a snippet in the workspace'</code>
<code class="emphasize">→[28]  c.Group←'Snippets'</code>
<code class="emphasize">→[29]  c.Parse←'1s -target='</code>
<code class="emphasize">→[30]  r,←c</code>
<code> [31] </code>
<code class="emphasize">→[32]  c←⎕NS''</code>
<code class="emphasize">→[33]  c.Name←'Save'</code>
<code class="emphasize">→[34]  c.Desc←'Save a function or operator or script or a piece of code as a snippet'</code>
<code class="emphasize">→[35]  c.Group←'Snippets'</code>
<code class="emphasize">→[36]  c.Parse←'1s -name='</code>
<code class="emphasize">→[37]  r,←c</code>
<code> [38] </code>
<code class="emphasize">→[39]  c←⎕NS''</code>
<code class="emphasize">→[40]  c.Name←'Delete'</code>
<code class="emphasize">→[41]  c.Desc←'Delete a snippet'</code>
<code class="emphasize">→[42]  c.Group←'Snippets'</code>
<code class="emphasize">→[43]  c.Parse←'1s -force'</code>
<code class="emphasize">→[44]  r,←c</code>
<code> [45] </code>
<code class="emphasize">→[46]  c←⎕NS''</code>
<code class="emphasize">→[47]  c.Name←'View'</code>
<code class="emphasize">→[48]  c.Desc←'View a snippet with ⎕ED'</code>
<code class="emphasize">→[49]  c.Group←'Snippets'</code>
<code class="emphasize">→[50]  c.Parse←'1s -session'</code>
<code class="emphasize">→[51]  r,←c</code>
<code> [52] </code>
<code class="emphasize">→[53]  c←⎕NS''</code>
<code class="emphasize">→[54]  c.Name←'Compare'</code>
<code class="emphasize">→[55]  c.Desc←'Compare an object in the workspace with a saved snippet'</code>
<code class="emphasize">→[56]  c.Group←'Snippets'</code>
<code class="emphasize">→[57]  c.Parse←'1-2'</code>
<code class="emphasize">→[58]  r,←c</code>
<code> [59] </code>
<code class="emphasize">→[60]  c←⎕NS''</code>
<code class="emphasize">→[61]  c.Name←'Help'</code>
<code class="emphasize">→[62]  c.Desc←'Provide a help page explaining the pronciples'</code>
<code class="emphasize">→[63]  c.Group←'Snippets'</code>
<code class="emphasize">→[64]  c.Parse←''</code>
<code class="emphasize">→[65]  r,←c</code>
<code> [66] </code>
<code class="emphasize">→[67]  c←⎕NS''</code>
<code class="emphasize">→[68]  c.Name←'Version'</code>
<code class="emphasize">→[69]  c.Desc←'Return the version number'</code>
<code class="emphasize">→[70]  c.Group←'Snippets'</code>
<code class="emphasize">→[71]  c.Parse←'0'</code>
<code class="emphasize">→[72]  r,←c</code>
</div>
<code class="header" id="listing_2">#.Snippets.Snippets_UC.Run &mdash; 0%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  r←Run(Cmd Args)</code>
<code> [1]   :Access Shared Public</code>
<code class="emphasize">→[2]   r←0 0⍴''</code>
<code class="emphasize">→[3]   :If 0=⎕SE.⎕NC'Snippets'</code>
<code class="emphasize">→[4]       {}⎕SE.Tatin.LoadDependencies(⊃⎕NPARTS ##.SourceFile)'⎕SE'</code>
<code> [5]   :EndIf</code>
<code class="emphasize">→[6]   SN←⎕SE.Snippets</code>
<code class="emphasize">→[7]   :Select ⎕C Cmd</code>
<code class="emphasize">→[8]   :Case ⎕C'List'</code>
<code class="emphasize">→[9]       r←List_ Args</code>
<code class="emphasize">→[10]  :Case ⎕C'Edit'</code>
<code class="emphasize">→[11]      r←Edit_ Args</code>
<code class="emphasize">→[12]  :Case ⎕C'Copy'</code>
<code class="emphasize">→[13]      r←Copy_ Args</code>
<code class="emphasize">→[14]  :Case ⎕C'Fix'</code>
<code class="emphasize">→[15]      r←Fix_ Args</code>
<code class="emphasize">→[16]  :Case ⎕C'Save'</code>
<code class="emphasize">→[17]      r←Save_ Args</code>
<code class="emphasize">→[18]  :Case ⎕C'Delete'</code>
<code class="emphasize">→[19]      r←Delete_ Args</code>
<code class="emphasize">→[20]  :Case ⎕C'Compare'</code>
<code class="emphasize">→[21]      r←Compare_ Args</code>
<code class="emphasize">→[22]  :Case ⎕C'View'</code>
<code class="emphasize">→[23]      r←View_ Args</code>
<code class="emphasize">→[24]  :Case ⎕C'Help'</code>
<code class="emphasize">→[25]      r←Help_ Args</code>
<code class="emphasize">→[26]  :Case ⎕C'Version'</code>
<code class="emphasize">→[27]      r←Version_</code>
<code> [28]  :Else</code>
<code class="emphasize">→[29]      ∘∘∘ ⍝ Huh?!</code>
<code> [30]  :EndSelect</code>
</div>
<code class="header" id="listing_3">#.Snippets.Snippets_UC._ &mdash; 0%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> r←_ ns</code>
<code class="emphasize">→[1]  r←{{⍵↑⍨¯1+⌊/⍵⍳'+"'}1↓⍵/⍨{⍵∨≠\⍵}⍵='"'}{⍵⊃⍨1⍳⍨∨/¨'version:'∘⍷¨⍵}(⎕UCS 13)(≠⊆⊢)SN.TatinVars.CONFIG</code>
</div>
<code class="header" id="listing_4">#.Snippets.Snippets_UC.Compare_ &mdash; 0%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> r←Compare_ ns</code>
<code class="emphasize">→[1]  r←'Sorry, not implemented yet'</code>
</div>
<code class="header" id="listing_5">#.Snippets.Snippets_UC.Help_ &mdash; 0%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> r←Help_</code>
<code class="emphasize">→[1]  r←0 0⍴''</code>
<code class="emphasize">→[2]  ⎕SE.ADOC.Browse SN</code>
</div>
<code class="header" id="listing_6">#.Snippets.Snippets_UC.Version_ &mdash; 0%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> r←Version_</code>
<code class="emphasize">→[1]  r←'0.1.0'</code>
</div>
<code class="header" id="listing_7">#.Snippets.Snippets_UC.Edit_ &mdash; 0%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  msg←Edit_ ns</code>
<code class="emphasize">→[1]   (opCode msg name filename)←'SelectSnippetForEdit@Please select snippet to be edited'GetNameAndFilename ns</code>
<code class="emphasize">→[2]   :If 1=opCode</code>
<code class="emphasize">→[3]       (name body)←GetNameAndBody filename</code>
<code class="emphasize">→[4]       ref←EstablishCodeInNamespace body</code>
<code class="emphasize">→[5]       ref.⎕ED name</code>
<code class="emphasize">→[6]       body2←GetCodeFromWS ref name</code>
<code class="emphasize">→[7]       :If ≡/body body2</code>
<code class="emphasize">→[8]           msg←'No change detected'</code>
<code class="emphasize">→[9]       :ElseIf 0=≢(∊body2)~⎕UCS 10 13</code>
<code class="emphasize">→[10]          msg←'Cancelled by user' ⋄ →0</code>
<code class="emphasize">→[11]      :ElseIf SN.CommTools.YesOrNo'Sure you want to save "',name,'" ?'</code>
<code class="emphasize">→[12]          (⊂body2)SN.FilesAndDirs.NPUT filename 1</code>
<code> [13]      :Else</code>
<code class="emphasize">→[14]          msg←'Cancelled by user' ⋄ →0</code>
<code> [15]      :EndIf</code>
<code> [16]  :EndIf</code>
</div>
<code class="header" id="listing_8">#.Snippets.Snippets_UC.Save_ &mdash; 0%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  msg←Save_ ns</code>
<code class="emphasize">→[1]   :If 0=≢ns.Arguments</code>
<code class="emphasize">→[2]       'cl'⎕WC'Clipboard'</code>
<code class="emphasize">→[3]       body←⊆cl.Text</code>
<code class="emphasize">→[4]       :If 0=≢name←''ns.Switch'name'</code>
<code class="emphasize">→[5]           name←({ns←⎕NS'' ⋄ 0=ns.⎕NC ⍵:1 ⋄ ⎕←'Please enter a valid APL name' ⋄ 0}SN.CommTools.AskForText)'name@Specify the name of the snippet'</code>
<code> [6]       :EndIf</code>
<code class="emphasize">→[7]       :If 0=≢name</code>
<code class="emphasize">→[8]           msg←'Cancelled by user' ⋄ →0</code>
<code> [9]       :EndIf</code>
<code> [10]  :Else</code>
<code class="emphasize">→[11]      name←ns._1</code>
<code class="emphasize">→[12]      :If '.'∊name</code>
<code class="emphasize">→[13]          parent←{⍵↓⍨-'.'⍳⍨⌽⍵}name</code>
<code class="emphasize">→[14]          ('Object not found',name)Assert 0&lt;≢parent</code>
<code> [15]      :Else</code>
<code class="emphasize">→[16]          parent←⊃{⍵/⍨~'['∊¨⍵}{⍵↓⍨+/∧\'⎕se'∘≡¨3↑¨⎕C ⍵}⎕NSI</code>
<code class="emphasize">→[17]          nc←parent.⎕NC name</code>
<code class="emphasize">→[18]          :If nc=¯1</code>
<code class="emphasize">→[19]              msg←'Invalid snippet name' ⋄ →0</code>
<code class="emphasize">→[20]          :ElseIf nc=0</code>
<code class="emphasize">→[21]              msg←'Name has no value?!' ⋄ →0</code>
<code> [22]          :EndIf</code>
<code> [23]      :EndIf</code>
<code class="emphasize">→[24]      ('Parent object not found: ',parent)Assert 9=⎕NC parent</code>
<code class="emphasize">→[25]      parent←⍎parent</code>
<code class="emphasize">→[26]      :Select ⊃parent.⎕NC name</code>
<code class="emphasize">→[27]      :Case ¯1</code>
<code class="emphasize">→[28]          ('Name &lt;',name,'&gt; is invalid')⎕SIGNAL 6</code>
<code class="emphasize">→[29]      :Case 0</code>
<code class="emphasize">→[30]          ('&lt;',name,'&gt; not found in ',⍕parent)⎕SIGNAL 6</code>
<code class="emphasize">→[31]      :Case 2</code>
<code class="emphasize">→[32]          ∘∘∘ ⋄ body←⊆ns._1</code>
<code class="emphasize">→[33]      :Case 9</code>
<code class="emphasize">→[34]          body←⎕SRC parent⍎name</code>
<code class="emphasize">→[35]      :CaseList 3 4</code>
<code class="emphasize">→[36]          body←parent.⎕NR name</code>
<code> [37]      :Else</code>
<code class="emphasize">→[38]          ∘∘∘  ⍝ Huh?!</code>
<code> [39]      :EndSelect</code>
<code> [40]  :EndIf</code>
<code class="emphasize">→[41]  :If 0=≢body</code>
<code class="emphasize">→[42]      msg←'No name was specified, and the clipboard does not contain code?!'</code>
<code> [43]  :Else</code>
<code class="emphasize">→[44]      nc←parent.⎕NC name</code>
<code class="emphasize">→[45]      :If nc∊3 4</code>
<code class="emphasize">→[46]          extension←'.aplf' '.aplo'[3 4⍳nc]</code>
<code> [47]      :Else</code>
<code class="emphasize">→[48]          nc←parent.⎕NC⊂name</code>
<code class="emphasize">→[49]          extension←(9.1 9.4 9.5⍳nc)⊃'.apln' '.aplc' '.apli'</code>
<code> [50]      :EndIf</code>
<code class="emphasize">→[51]      name_←{⍵↑⍨-¯1+'.'⍳⍨⌽⍵}name</code>
<code class="emphasize">→[52]      filename←GetHomeFolder,name_,extension</code>
<code class="emphasize">→[53]      :If SN.FilesAndDirs.IsFile filename</code>
<code class="emphasize">→[54]          q←'The file already exists - overwrite?'</code>
<code class="emphasize">→[55]          :If SN.CommTools.YesOrNo q</code>
<code class="emphasize">→[56]              SN.FilesAndDirs.DeleteFile filename</code>
<code> [57]          :Else</code>
<code class="emphasize">→[58]              msg←'Cancelled by user' ⋄ →0</code>
<code> [59]          :EndIf</code>
<code class="emphasize">→[60]      :ElseIf SN.FilesAndDirs.IsDir filename</code>
<code class="emphasize">→[61]          msg←'Cannot continue: ',filename,' is a directory' ⋄ →0</code>
<code> [62]      :EndIf</code>
<code class="emphasize">→[63]      :Trap 0</code>
<code class="emphasize">→[64]          ref←name_{ns←⎕NS'' ⋄ _←⍎'ns.',⍺,'←,/⍵,¨⎕UCS 10' ⋄ ns}body</code>
<code> [65]      :Else</code>
<code class="emphasize">→[66]          qdmx←⎕DMX</code>
<code class="emphasize">→[67]          msg←qdmx.EM{0=≢⍵:⍺ ⋄ ⍵}qdmx.Message ⋄ →0</code>
<code> [68]      :EndTrap</code>
<code class="emphasize">→[69]      (⊂body)SN.FilesAndDirs.NPUT filename</code>
<code class="emphasize">→[70]      msg←'Code snippet successfully saved as ',⊃,/1↓⎕NPARTS filename</code>
<code> [71]  :EndIf</code>
</div>
<code class="header" id="listing_9">#.Snippets.Snippets_UC.Delete_ &mdash; 0%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> msg←Delete_ ns</code>
<code class="emphasize">→[1]  (filenames snippetNames ind name msg)←CollectSnippetInfo'to copy to clipboard'({0≡⍵:'' ⋄ ⍵}ns._1)</code>
<code class="emphasize">→[2]  :If 0&lt;≢name</code>
<code class="emphasize">→[3]      :If SN.FilesAndDirs.DeleteFile ind⊃filenames</code>
<code class="emphasize">→[4]          msg←'Snippet deleted: ',name</code>
<code> [5]      :EndIf</code>
<code> [6]  :EndIf</code>
</div>
<code class="header" id="listing_10">#.Snippets.Snippets_UC.Fix_ &mdash; 0%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  msg←Fix_ ns</code>
<code class="emphasize">→[1]   (filenames snippetNames ind name msg)←0 CollectSnippetInfo'to fix in the workspace'({0≡⍵:'' ⋄ ⍵}ns._1)</code>
<code class="emphasize">→[2]   parent←''ns.Switch'target'</code>
<code class="emphasize">→[3]   :If 0&lt;≢name</code>
<code class="emphasize">→[4]       :If 0=≢parent</code>
<code class="emphasize">→[5]           :If (,'#')≢parent←⊃{⍵/⍨~'['∊¨⍵}{⍵↓⍨+/∧\'⎕se'∘≡¨3↑¨⎕C ⍵}⎕NSI</code>
<code class="emphasize">→[6]               index←'Where do you want to fix it:'SN.CommTools.Select(⊂,'#'),⊂parent</code>
<code class="emphasize">→[7]               :If 0=≢index</code>
<code class="emphasize">→[8]                   msg←'Cancelled by user' ⋄ →0</code>
<code> [9]               :EndIf</code>
<code class="emphasize">→[10]              parent←⍎index⊃'#'parent</code>
<code> [11]          :Else</code>
<code class="emphasize">→[12]              parent←#</code>
<code> [13]          :EndIf</code>
<code> [14]      :Else</code>
<code class="emphasize">→[15]          parent←⍎parent</code>
<code> [16]      :EndIf</code>
<code class="emphasize">→[17]      body←GetCodeFromFile ind⊃filenames</code>
<code class="emphasize">→[18]      body←{2=⍴⍴⍵:⍵ ⋄ ,⊆⍵}body</code>
<code class="emphasize">→[19]      :Trap 0</code>
<code class="emphasize">→[20]          name←GetNameFromBody body</code>
<code> [21]      :Else</code>
<code class="emphasize">→[22]          qdmx←⎕DMX</code>
<code class="emphasize">→[23]          qdmx.EM ⎕SIGNAL qdmx.EN</code>
<code> [24]      :EndTrap</code>
<code class="emphasize">→[25]      :Select ⊃parent.⎕NC name</code>
<code class="emphasize">→[26]      :Case 0</code>
<code> [27]               ⍝ Name is okay and not in use, nothing to do</code>
<code class="emphasize">→[28]      :Case ¯1</code>
<code class="emphasize">→[29]          ('Invalid name: ',name)⎕SIGNAL 11</code>
<code> [30]      :Else</code>
<code class="emphasize">→[31]          q←'"',name,'" already used in ',(⍕parent),'; overwrite?'</code>
<code class="emphasize">→[32]          :If 0=SN.CommTools.YesOrNo q</code>
<code class="emphasize">→[33]              msg←'Cancelled by user' ⋄ →0</code>
<code> [34]          :EndIf</code>
<code class="emphasize">→[35]          parent.⎕EX name</code>
<code> [36]      :EndSelect</code>
<code class="emphasize">→[37]      :If (⊂3⊃⎕NPARTS ind⊃filenames)∊'.aplf' '.aplo'</code>
<code class="emphasize">→[38]          buff←parent.⎕FX body</code>
<code class="emphasize">→[39]          :If ' '=1↑0⍴∊buff</code>
<code class="emphasize">→[40]              msg←'"',name,'" fixed in ',⍕parent</code>
<code> [41]          :Else</code>
<code class="emphasize">→[42]              msg←'Attempt to fix "',name,'" caused an error in line ',⍕buff</code>
<code> [43]          :EndIf</code>
<code class="emphasize">→[44]          {}⎕SE.Link.Add(⍕parent),'.',name</code>
<code> [45]      :Else</code>
<code class="emphasize">→[46]          :Trap 0</code>
<code class="emphasize">→[47]              {}parent.⎕FIX body</code>
<code> [48]          :Else</code>
<code class="emphasize">→[49]              msg←'Attempt to fix "',name,'" caused an error'</code>
<code> [50]          :EndTrap</code>
<code> [51]      :EndIf</code>
<code> [52]  :Else</code>
<code class="emphasize">→[53]      msg←'No such (fixable) snippet found'</code>
<code> [54]  :EndIf</code>
</div>
<code class="header" id="listing_11">#.Snippets.Snippets_UC.Copy_ &mdash; 0%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  msg←Copy_ ns</code>
<code class="emphasize">→[1]   :If 'Win'≡3↑1⊃'#'⎕WG'APLVersion'</code>
<code class="emphasize">→[2]       (filenames snippetNames ind name msg)←CollectSnippetInfo'to copy to clipboard'({0≡⍵:'' ⋄ ⍵}ns._1)</code>
<code class="emphasize">→[3]       :If 0=≢msg</code>
<code class="emphasize">→[4]           success←0</code>
<code class="emphasize">→[5]           :Repeat</code>
<code class="emphasize">→[6]               :Trap 0 ⍝ Yes, this fails occasionally under Windows for no reason at all</code>
<code class="emphasize">→[7]                   'cl'⎕WC'Clipboard'</code>
<code class="emphasize">→[8]                   cl.Text←GetCodeFromFile ind⊃filenames</code>
<code class="emphasize">→[9]                   success←1</code>
<code> [10]              :Else</code>
<code class="emphasize">→[11]                  ⎕DL 0.01</code>
<code> [12]              :EndTrap</code>
<code class="emphasize">→[13]          :Until success</code>
<code class="emphasize">→[14]          msg←'Copied to the clipboard: ',ind⊃snippetNames</code>
<code> [15]      :EndIf</code>
<code> [16]  :Else</code>
<code class="emphasize">→[17]      msg←'This command is only available on Windows'</code>
<code> [18]  :EndIf</code>
</div>
<code class="header" id="listing_12">#.Snippets.Snippets_UC.List_ &mdash; 0%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  r←List_ ns</code>
<code class="emphasize">→[1]   r←'No snippets found'</code>
<code class="emphasize">→[2]   folder←GetHomeFolder</code>
<code class="emphasize">→[3]   list←SN.FilesAndDirs.ListFiles folder</code>
<code class="emphasize">→[4]   full←ns.Switch'full'</code>
<code class="emphasize">→[5]   :If 0&lt;≢list</code>
<code class="emphasize">→[6]       list2←{2⊃⎕NPARTS ⍵}¨list</code>
<code class="emphasize">→[7]       name←ns._1</code>
<code class="emphasize">→[8]       :If 0≢name</code>
<code class="emphasize">→[9]           :If '*'∊name</code>
<code class="emphasize">→[10]              bool←(name~'*'){(⎕C ⍺)∘≡¨⎕C(≢⍺)↑¨⍵}list2</code>
<code> [11]          :Else</code>
<code class="emphasize">→[12]              bool←(⎕C list2)≡¨⊂⎕C name</code>
<code> [13]          :EndIf</code>
<code class="emphasize">→[14]          (list list2)←bool∘/¨list list2</code>
<code> [15]      :EndIf</code>
<code class="emphasize">→[16]  :AndIf 0&lt;≢list</code>
<code class="emphasize">→[17]      :If full</code>
<code class="emphasize">→[18]          r←list</code>
<code> [19]      :Else</code>
<code class="emphasize">→[20]          r←list2</code>
<code> [21]      :EndIf</code>
<code class="emphasize">→[22]      :If ns.Switch'short'</code>
<code class="emphasize">→[23]          r←⍪(⊂'*** Folder: ',folder),' ',¨r</code>
<code> [24]      :Else</code>
<code class="emphasize">→[25]          comments←GetComment¨list</code>
<code class="emphasize">→[26]          :If 0&lt;≢ind←⍸{'.code'≡3⊃⎕NPARTS ⍵}¨list</code>
<code class="emphasize">→[27]              comments[ind]←∊∘GetCodeFromFile¨list[ind]</code>
<code> [28]          :EndIf</code>
<code class="emphasize">→[29]          r←r,[1.5]comments</code>
<code class="emphasize">→[30]          r←'*** Folder:'folder⍪r</code>
<code> [31]      :EndIf</code>
<code class="emphasize">→[32]      r←⍕r</code>
<code class="emphasize">→[33]      r←CutWidth r</code>
<code> [34]  :EndIf</code>
</div>
<code class="header" id="listing_13">#.Snippets.Snippets_UC.View_ &mdash; 0%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  r←View_ ns</code>
<code class="emphasize">→[1]   r←''</code>
<code class="emphasize">→[2]   (opCode r name filename)←'SelectSnippetForView@Please select snippet to be viewed'GetNameAndFilename ns</code>
<code class="emphasize">→[3]   :If 1=opCode</code>
<code class="emphasize">→[4]       session←ns.Switch'session'</code>
<code class="emphasize">→[5]       :If session</code>
<code class="emphasize">→[6]           r←⊃SN.FilesAndDirs.NGET filename 1</code>
<code class="emphasize">→[7]           r←⍪↓DLB↑r</code>
<code class="emphasize">→[8]           r←(⊂(⎕PW-5)⍴'-')⍪r</code>
<code> [9]       :Else</code>
<code class="emphasize">→[10]          (name body)←2↑GetNameAndBody filename</code>
<code class="emphasize">→[11]          ref←EstablishCodeInNamespace body</code>
<code class="emphasize">→[12]          ref.{{}(⎕ED⍠('ReadOnly' 1)&amp;⍵)}name</code>
<code> [13]      :EndIf</code>
<code> [14]  :EndIf</code>
</div>
<code class="header" id="listing_14">#.Snippets.Snippets_UC.Help &mdash; 0%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>   r←level Help Cmd</code>
<code> [1]    :Access Shared Public</code>
<code class="emphasize">→[2]    r←''</code>
<code class="emphasize">→[3]    :Select level</code>
<code class="emphasize">→[4]    :Case 0</code>
<code class="emphasize">→[5]        :Select ⎕C Cmd</code>
<code class="emphasize">→[6]        :Case ⎕C'List'</code>
<code class="emphasize">→[7]            r,←⊂'List all saved snippets with the first comment line unless -short is specified'</code>
<code class="emphasize">→[8]            r,←⊂']Snippets.List [name*] -short -full'</code>
<code class="emphasize">→[9]        :Case ⎕C'Edit'</code>
<code class="emphasize">→[10]           r,←⊂'Edit a snippet'</code>
<code class="emphasize">→[11]           r,←⊂']Snippets.Edit [name*]'</code>
<code class="emphasize">→[12]       :Case ⎕C'Copy'</code>
<code class="emphasize">→[13]           r,←⊂'Copy a snippet to the clipboard (Windows only)'</code>
<code class="emphasize">→[14]           r,←⊂']Snippets.Copy [name*]'</code>
<code class="emphasize">→[15]       :Case ⎕C'Fix'</code>
<code class="emphasize">→[16]           r,←⊂'Fix a snippet in the workspace'</code>
<code class="emphasize">→[17]           r,←⊂']Snippets.Fix &lt;name&gt; -target='</code>
<code class="emphasize">→[18]       :Case ⎕C'Save'</code>
<code class="emphasize">→[19]           r,←⊂'Save a function or operator or script or a piece of code as a snippet'</code>
<code class="emphasize">→[20]           r,←⊂']Snippets.Save [name] -name='</code>
<code class="emphasize">→[21]       :Case ⎕C'Delete'</code>
<code class="emphasize">→[22]           r,←⊂'Delete a saved snippet'</code>
<code class="emphasize">→[23]           r,←⊂']Snippets.Delete [name*] -force'</code>
<code class="emphasize">→[24]       :Case ⎕C'Compare'</code>
<code class="emphasize">→[25]           r,←⊂'Compare a function, operator or script with a saved snippet'</code>
<code class="emphasize">→[26]           r,←⊂']Snippets.Compare &lt;object-name&gt;'</code>
<code class="emphasize">→[27]       :Case ⎕C'View'</code>
<code class="emphasize">→[28]           r,←⊂'Bring the code of a snippet into ⎕ED'</code>
<code class="emphasize">→[29]           r,←⊂']Snippets.Show [&lt;name*&gt;] -session'</code>
<code class="emphasize">→[30]       :Case ⎕C'Version'</code>
<code class="emphasize">→[31]           r,←⊂'Return the version number of the snippet manager'</code>
<code class="emphasize">→[32]           r,←⊂']Snippets.Version'</code>
<code> [33]       :EndSelect</code>
<code class="emphasize">→[34]       :If ~(⊂⎕C Cmd)∊⎕C'Version' 'Help'</code>
<code class="emphasize">→[35]           r,←''(']Cider.',Cmd,' -?? ⍝ Enter this for more information ')</code>
<code> [36]       :EndIf</code>
<code class="emphasize">→[37]   :Case 1</code>
<code class="emphasize">→[38]       :Select ⎕C Cmd</code>
<code class="emphasize">→[39]       :Case ⎕C'List'</code>
<code class="emphasize">→[40]           r,←⊂'Lists all saved snippets with the first comment line unless -short is specified.'</code>
<code class="emphasize">→[41]           r,←⊂'In case -full is specified the full filename rather than just the snippet name is shown.'</code>
<code class="emphasize">→[42]           r,←⊂''</code>
<code class="emphasize">→[43]           r,←⊂'* If no name is given all snippets are listed'</code>
<code class="emphasize">→[44]           r,←⊂'* If something is specified all snippets that start with the argument are listed'</code>
<code class="emphasize">→[45]           r,←⊂'  The search is not case sensitive.'</code>
<code class="emphasize">→[46]           r,←⊂'* In case -short is specified only the names are listed but no comments'</code>
<code class="emphasize">→[47]       :Case ⎕C'Edit'</code>
<code class="emphasize">→[48]           r,←⊂'Allows you to edit a snippet as if it were a variable in the workspace.'</code>
<code class="emphasize">→[49]           r,←⊂''</code>
<code class="emphasize">→[50]           r,←⊂'* If no argument is specified all snippets are listed and you may select one'</code>
<code class="emphasize">→[51]           r,←⊂'* If an argument is specified but carries a trailing asterisk all snippets with'</code>
<code class="emphasize">→[52]           r,←⊂'  corresponding names are listed. The search is not case sensitive.'</code>
<code class="emphasize">→[53]           r,←⊂'* If an argument is specified without a trailing asterisk the name given must match a'</code>
<code class="emphasize">→[54]           r,←⊂'  snippet, otherwise an error is signalled. The search is not case sensitive.'</code>
<code class="emphasize">→[55]       :Case ⎕C'Copy'</code>
<code class="emphasize">→[56]           r,←⊂'Copies a snippet to the clipboard (Windows only)'</code>
<code class="emphasize">→[57]           r,←⊂''</code>
<code class="emphasize">→[58]           r,←⊂'* If no argument is specified all snippets are listed and the user may select one'</code>
<code class="emphasize">→[59]           r,←⊂'* If an argument is specified but carries a trailing asterisk all snippets with'</code>
<code class="emphasize">→[60]           r,←⊂'  corresponding names are listed for selection. The search is not case sensitive.'</code>
<code class="emphasize">→[61]           r,←⊂'* If an argument is specified without a trailing asterisk, a snippet with that name'</code>
<code class="emphasize">→[62]           r,←⊂'  will be copied. The search is not case sensitive.'</code>
<code class="emphasize">→[63]       :Case ⎕C'Fix'</code>
<code class="emphasize">→[64]           r,←⊂'Fixes a snippet into the workspace'</code>
<code class="emphasize">→[65]           r,←⊂''</code>
<code class="emphasize">→[66]           r,←⊂'* If no argument is specified all snippets are listed except those stored in .code'</code>
<code class="emphasize">→[67]           r,←⊂'  files: they cannot be fixed by definition. The user can then select one of them.'</code>
<code class="emphasize">→[68]           r,←⊂'* If an argument is specified but carries a trailing asterisk all snippets with'</code>
<code class="emphasize">→[69]           r,←⊂'  corresponding names are listed for selection. The search is not case sensitive.'</code>
<code class="emphasize">→[70]           r,←⊂'* If an argument is specified without a trailing asterisk a snippet with that name'</code>
<code class="emphasize">→[71]           r,←⊂'  will be fixed. The search is not case sensitive.'</code>
<code class="emphasize">→[72]           r,←⊂'  If no snippet is found an error is signalled.'</code>
<code class="emphasize">→[73]           r,←⊂'* If -target is not specified the snipped will be fixed in # unless the user is'</code>
<code class="emphasize">→[74]           r,←⊂'  currently in a sub-namespace of #, when the user will be asked what to do.'</code>
<code class="emphasize">→[75]       :Case ⎕C'Save'</code>
<code class="emphasize">→[76]           r,←⊂'Saves a function or operator or script as a snippet'</code>
<code class="emphasize">→[77]           r,←⊂''</code>
<code class="emphasize">→[78]           r,←⊂'* If an argument is specified it is interpreted as a fully qualified name to the'</code>
<code class="emphasize">→[79]           r,←⊂'  function, operator or script to be saved'</code>
<code class="emphasize">→[80]           r,←⊂'* By default the name of the APL object defines the name of the snippet'</code>
<code class="emphasize">→[81]           r,←⊂'* With the -name= option you can specify a different name'</code>
<code class="emphasize">→[82]           r,←⊂'* If no argument is specified at all and there is text on the clipboard the user'</code>
<code class="emphasize">→[83]           r,←⊂'  command assumes that you want to save the clipboard content as a snippet'</code>
<code class="emphasize">→[84]           r,←⊂'  In this case a confirmation is required.'</code>
<code class="emphasize">→[85]       :Case ⎕C'Delete'</code>
<code class="emphasize">→[86]           r,←⊂'Deletes a saved snippet'</code>
<code class="emphasize">→[87]           r,←⊂''</code>
<code class="emphasize">→[88]           r,←⊂'* When an argument is specified any matching snippet will be deleted. The search will'</code>
<code class="emphasize">→[89]           r,←⊂'  not be case sensitive. If the argument carries a trailing asterisk all matching'</code>
<code class="emphasize">→[90]           r,←⊂'  snippets will be presented for selection.'</code>
<code class="emphasize">→[91]           r,←⊂'* The user must always confirm a delete operation except when -force is specified'</code>
<code class="emphasize">→[92]           r,←⊂'* When no argument is specified all snippets will be presented for selection'</code>
<code class="emphasize">→[93]           r,←⊂'* -force has no effect in case the user is presented a list with more than one snippet'</code>
<code class="emphasize">→[94]       :Case ⎕C'Compare'</code>
<code class="emphasize">→[95]           r,←⊂'Compares a function, operator or script with a saved snippet'</code>
<code class="emphasize">→[96]           r,←⊂''</code>
<code class="emphasize">→[97]           r,←⊂'This command requires at least one argument and accepts up to two.'</code>
<code class="emphasize">→[98]           r,←⊂''</code>
<code class="emphasize">→[99]           r,←⊂'* A single argument is interpreted as the name of an APL object. If it is not fully'</code>
<code class="emphasize">→[100]          r,←⊂'  qualified it is assumed to live in the namespace the user command was called from.'</code>
<code class="emphasize">→[101]          r,←⊂'* A second argument must be the name of a snippet. If this is not specified the user'</code>
<code class="emphasize">→[102]          r,←⊂'  will be presented a list withh all snippets for selection.'</code>
<code class="emphasize">→[103]          r,←⊂'* If the second argument carries a trailing asterisk all matching snippets will be'</code>
<code class="emphasize">→[104]          r,←⊂'  presented for selection. The search will not be case sensitive.'</code>
<code class="emphasize">→[105]          r,←⊂'* If the user command ]CompareFiles (and its API) is available this will be used to'</code>
<code class="emphasize">→[106]          r,←⊂'  carry out the comparison, otherwise two files are printed to the session.'</code>
<code class="emphasize">→[107]          r,←⊂''</code>
<code class="emphasize">→[108]      :Case ⎕C'View'</code>
<code class="emphasize">→[109]          r,←⊂'Brings the code of a given snippet into ⎕ED.'</code>
<code class="emphasize">→[110]          r,←⊂''</code>
<code class="emphasize">→[111]          r,←⊂'If a given name does not result in a match it is interpreted as "search for all that'</code>
<code class="emphasize">→[112]          r,←⊂'start with the given string". If several snippets match the user is given a list to'</code>
<code class="emphasize">→[113]          r,←⊂'select from. The search is case insensitive.'</code>
<code class="emphasize">→[114]          r,←⊂''</code>
<code class="emphasize">→[115]          r,←⊂'-session Prints the code to the session rather than bringing it into ⎕ED'</code>
<code class="emphasize">→[116]      :Case ⎕C'Version'</code>
<code class="emphasize">→[117]          r,←⊂'Returns the version number of the ]Snippets user command'</code>
<code> [118]      :EndSelect</code>
<code class="emphasize">→[119]  :Case 2</code>
<code class="emphasize">→[120]      r,←⊂'There is no additional help available'</code>
<code> [121]  :EndSelect</code>
</div>
<code class="header" id="listing_15">#.Snippets.Snippets_UC.GetNameAndFilename &mdash; 0%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  (opCode msg name filename)←caption GetNameAndFilename ns</code>
<code> [1]      ⍝ opCodes:</code>
<code> [2]      ⍝  0 = nothing to do (for example, no snippets found)</code>
<code> [3]      ⍝  1 = All fine, carry on</code>
<code> [4]      ⍝ ¯1 = Snippet not found</code>
<code> [5]      ⍝ ¯2 = Cancelled by user</code>
<code class="emphasize">→[6]   msg←name←filename←''</code>
<code class="emphasize">→[7]   :If 0&lt;≢list←SN.FilesAndDirs.ListFiles GetHomeFolder</code>
<code class="emphasize">→[8]       list2←{2⊃⎕NPARTS ⍵}¨list</code>
<code class="emphasize">→[9]       name←{0≡⍵:'' ⋄ ⍵}ns._1</code>
<code class="emphasize">→[10]      :If 0&lt;≢name</code>
<code class="emphasize">→[11]          :If '*'∊name</code>
<code class="emphasize">→[12]              ind←⍸(name~'*'){(⎕C ⍺)∘≡¨⎕C(≢⍺)↑¨⍵}list2</code>
<code class="emphasize">→[13]              :If 1&lt;≢ind</code>
<code class="emphasize">→[14]                  :If 0=≢ind2←caption SN.CommTools.Select list2[ind]</code>
<code class="emphasize">→[15]                      msg←'Cancelled by user' ⋄ opCode←¯2 ⋄ →0</code>
<code> [16]                  :EndIf</code>
<code class="emphasize">→[17]                  ind←ind[ind2]</code>
<code> [18]              :EndIf</code>
<code> [19]          :Else</code>
<code class="emphasize">→[20]              :If 0=≢ind←⍸(⎕C list2)≡¨⊂⎕C name</code>
<code class="emphasize">→[21]                  msg←'Snippet not found' ⋄ opCode←¯1 ⋄ →0</code>
<code> [22]              :EndIf</code>
<code> [23]          :EndIf</code>
<code> [24]      :Else</code>
<code class="emphasize">→[25]          :If 0=≢ind←caption SN.CommTools.Select list2</code>
<code class="emphasize">→[26]              msg←'Cancelled by user' ⋄ opCode←¯2 ⋄ →0</code>
<code> [27]          :EndIf</code>
<code> [28]      :EndIf</code>
<code class="emphasize">→[29]      name←ind⊃list2</code>
<code class="emphasize">→[30]      filename←ind⊃list</code>
<code class="emphasize">→[31]      opCode←1</code>
<code> [32]  :Else</code>
<code class="emphasize">→[33]      msg←'Cancelled by user' ⋄ opCode←¯2 ⋄</code>
<code> [34]  :EndIf</code>
</div>
<code class="header" id="listing_16">#.Snippets.Snippets_UC.GetNameFromBody &mdash; 0%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> name←GetNameFromBody body</code>
<code class="emphasize">→[1]  :If ∨/':class' ':namespace'{⍺≡(≢⍺)↑⍵}¨⊂⎕C' '~⍨⊃body</code>
<code class="emphasize">→[2]      name←{⍵↑⍨¯1+⍵⍳' '}{⍵↓⍨+⍵⍳' '}DLB⊃body</code>
<code> [3]  :Else</code>
<code class="emphasize">→[4]      name←⊃(⎕NS'').{' '≠1↑0⍴∊⎕FX ⍵: ⋄ ' '~⍨¨↓⎕NL⍳16}body</code>
<code> [5]  :EndIf</code>
</div>
<code class="header" id="listing_17">#.Snippets.Snippets_UC.GetNameAndBody &mdash; 0%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> (name body)←GetNameAndBody filename</code>
<code class="emphasize">→[1]  body←⊃⎕NGET filename 1</code>
<code class="emphasize">→[2]  body←(-+/∧\0=⌽≢¨body)↓body</code>
<code class="emphasize">→[3]  name←GetNameFromBody body</code>
</div>
<code class="header" id="listing_18">#.Snippets.Snippets_UC.EstablishCodeInNamespace &mdash; 0%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> ref←EstablishCodeInNamespace body</code>
<code class="emphasize">→[1]  ref←⎕NS''</code>
<code class="emphasize">→[2]  :If ∨/':class' ':namespace'{⍺≡(≢⍺)↑⍵}¨⊂⎕C' '~⍨⊃body</code>
<code class="emphasize">→[3]      ref.⎕FIX body</code>
<code> [4]  :Else</code>
<code class="emphasize">→[5]      ref.⎕FX body</code>
<code> [6]  :EndIf</code>
</div>
<code class="header" id="listing_19">#.Snippets.Snippets_UC.GetCodeFromWS &mdash; 0%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> body←GetCodeFromWS(ref name)</code>
<code class="emphasize">→[1]  :If ref IsScripted name</code>
<code class="emphasize">→[2]      ∘∘∘  ⍝TODO⍝ Scripts are not yet supported</code>
<code> [3]  :Else</code>
<code class="emphasize">→[4]      body←↓ref.⎕CR name</code>
<code class="emphasize">→[5]      body←{⍵↓⍨-+/∧\' '=⌽⍵}¨body</code>
<code> [6]  :EndIf</code>
</div>
<code class="header" id="listing_20">#.Snippets.Snippets_UC.GetCodeFromFile &mdash; 0%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> body←GetCodeFromFile filename</code>
<code class="emphasize">→[1]  body←⊃SN.FilesAndDirs.NGET filename 1</code>
<code class="emphasize">→[2]  :If 1=≢body</code>
<code class="emphasize">→[3]  :AndIf (⊂3⊃⎕NPARTS filename)∊'.aplf' '.aplo' '.code'</code>
<code class="emphasize">→[4]      buff←{⍵{⍵\⍵/⍺}{~⍵∨≠\⍵}''''=⍵}⊃body ⍝ Wipe out anything quoted</code>
<code class="emphasize">→[5]      body←⊂(¯1+buff⍳'⍝')↑⊃body</code>
<code> [6]  :EndIf</code>
<code class="emphasize">→[7]  body←↓DLB↑body</code>
</div>
<code class="header" id="listing_21">#.Snippets.Snippets_UC.IsScripted &mdash; 0%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> r←{x}IsScripted y</code>
<code> [1]     ⍝ Returns a 1 for classes, interfaces and scripted namespaces and 0 otherwise.</code>
<code class="emphasize">→[2]  ref←{0&lt;⎕NC'x':⍎⍵ ⋄ ⎕THIS}'x'</code>
<code class="emphasize">→[3]  r←ref.{11 16::0 ⋄ 1⊣⎕SRC ⍵}y</code>
</div>
<code class="header" id="listing_22">#.Snippets.Snippets_UC.GetComment &mdash; 0%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  r←GetComment filename</code>
<code class="emphasize">→[1]   body←⊃SN.FilesAndDirs.NGET filename 1</code>
<code class="emphasize">→[2]   :If 1=≢body</code>
<code class="emphasize">→[3]   :AndIf (⊂3⊃⎕NPARTS filename)∊'.aplf' '.aplo' '.code'</code>
<code class="emphasize">→[4]       buff←{⍵{⍵\⍵/⍺}{~⍵∨≠\⍵}''''=⍵}⊃body ⍝ Wipe out anything quoted</code>
<code class="emphasize">→[5]       r←DLB(buff⍳'⍝')↓⊃body</code>
<code> [6]   :Else</code>
<code class="emphasize">→[7]       body←DLB¨{(+/∧\';'=⊃¨⍵)↓⍵}1↓body</code>
<code class="emphasize">→[8]       :If '⍝'=⊃⊃body</code>
<code class="emphasize">→[9]           r←DLB 1↓⊃body</code>
<code> [10]      :Else</code>
<code class="emphasize">→[11]          r←''</code>
<code> [12]      :EndIf</code>
<code> [13]  :EndIf</code>
</div>
<code class="header" id="listing_23">#.Snippets.Snippets_UC.CutWidth &mdash; 0%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> r←CutWidth r</code>
<code class="emphasize">→[1]  :If ⎕PW&lt;1+2⊃⍴r</code>
<code class="emphasize">→[2]      rows←⍸∨/' '≠⎕PW↓[2]r</code>
<code class="emphasize">→[3]      r[rows;(⎕PW-3)+⍳3]←'.'</code>
<code class="emphasize">→[4]      r←⎕PW↑[2]r</code>
<code> [5]  :EndIf</code>
</div>
<code class="header" id="listing_24">#.Snippets.Snippets_UC.GetHomeFolder &mdash; 0%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> folder←GetHomeFolder</code>
<code class="emphasize">→[1]  folder←(⊃⎕NPARTS ##.SourceFile),'.snippets/'</code>
<code class="emphasize">→[2]  3 ⎕MKDIR folder</code>
</div>
<code class="header" id="listing_25">#.Snippets.Snippets_UC.CollectSnippetInfo &mdash; 0%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  (filenames snippetNames ind name msg)←{all}CollectSnippetInfo(caption txt)</code>
<code class="emphasize">→[1]   all←{0&lt;⎕NC ⍵:⍎⍵ ⋄ 1}'all'</code>
<code class="emphasize">→[2]   filenames←snippetNames←msg←''</code>
<code class="emphasize">→[3]   folder←GetHomeFolder</code>
<code class="emphasize">→[4]   filenames←SN.FilesAndDirs.ListFiles folder</code>
<code class="emphasize">→[5]   :If 0=≢filenames</code>
<code class="emphasize">→[6]       msg←'No ',((~all)/'fixable'),' snippets found' ⋄ →0</code>
<code> [7]   :EndIf</code>
<code class="emphasize">→[8]   :If ~all</code>
<code class="emphasize">→[9]       filenames←('.code'∘≢¨3⊃∘⎕NPARTS¨filenames)/filenames</code>
<code> [10]  :EndIf</code>
<code class="emphasize">→[11]  :If 0=≢filenames</code>
<code class="emphasize">→[12]      msg←'No ',((~all)/'fixable'),' snippets found' ⋄ →0</code>
<code> [13]  :EndIf</code>
<code class="emphasize">→[14]  snippetNames←2⊃∘⎕NPARTS¨filenames</code>
<code class="emphasize">→[15]  name←''</code>
<code class="emphasize">→[16]  :If 0=≢txt</code>
<code class="emphasize">→[17]      txt←'*'</code>
<code> [18]  :EndIf</code>
<code class="emphasize">→[19]  :If '*'∊name←txt</code>
<code class="emphasize">→[20]      ind←⍸(⎕C name~'*'){⍺∘≡¨⎕C(≢⍺)↑¨⍵}snippetNames</code>
<code class="emphasize">→[21]      :If 0=≢ind</code>
<code class="emphasize">→[22]          msg←'No match found' ⋄ name←'' ⋄ →0</code>
<code> [23]      :EndIf</code>
<code class="emphasize">→[24]      :If 1=≢ind</code>
<code class="emphasize">→[25]          name←ind⊃snippetNames</code>
<code> [26]      :Else</code>
<code class="emphasize">→[27]          ind2←('Select snippet ',caption)SN.CommTools.Select 1↓↓List_ ns</code>
<code class="emphasize">→[28]          :If 0=≢ind2</code>
<code class="emphasize">→[29]              name←''</code>
<code class="emphasize">→[30]              msg←'Cancelled by user'</code>
<code> [31]          :Else</code>
<code class="emphasize">→[32]              ind←ind[ind2]</code>
<code class="emphasize">→[33]              name←ind⊃snippetNames</code>
<code> [34]          :EndIf</code>
<code> [35]      :EndIf</code>
<code> [36]  :Else</code>
<code class="emphasize">→[37]      ind←⍸(⎕C snippetNames)≡¨⊂⎕C name</code>
<code class="emphasize">→[38]      :If 0=≢ind</code>
<code class="emphasize">→[39]          msg←'No snippet found'</code>
<code class="emphasize">→[40]          name←''</code>
<code> [41]      :Else</code>
<code class="emphasize">→[42]          name←ind⊃snippetNames</code>
<code> [43]      :EndIf</code>
<code> [44]  :EndIf</code>
</div>
<code class="header" id="listing_26">#.Snippets.Snippets_UC.ref &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block missing">Could not get canonical representation.</div>
<code class="header" id="listing_27">#.Snippets.Snippets_UC.all &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block missing">Could not get canonical representation.</div>
<div id="footer">
<hr>
<p>Created by "CodeCoverage" version 0.10.3+52 from 2023-06-23</p>
</div>

</body>
</html>
