<!DOCTYPE html>
<html lang="en">
<head>
<title>Coverage</title>
<meta charset="utf-8"/>
<style>
@media screen{
    html {background-color: #FFFFF0;}
body {
    font-size: 16px;
    font-family : Verdana, "Bitstream Vera Sans", "DejaVu Sans", Tahoma, Geneva, Arial, Sans-serif;
    margin: 1em;
}
th, td {padding: 5px 10px;}
th {text-align: left;}
h1, h2, h3, h4, h5, h6 {color: #424242;}
h1 {font-size: 22px;}
h2 {font-size: 18px; margin-top: 2em; margin-bottom:0.3em;}
tbody tr:nth-child(even) {background-color: #F0F0F0;}
tbody tr:nth-child(odd) {background-color: #FAFAFA;}
th {background-color: #E6E6E6;color: #424242;}
table {border: silver 1px solid; font-size: 14px;font-family: APLFont, monospace;}
code , code a {font-size: 14px; font-family: APLFont, monospace;}
code.header {
    font-size: 16px; 
    font-family: APLFont, monospace; 
    margin: 1.5em 0.5em 0 0.5em; 
    padding:0;
    display: block;
}
div.code-block {
    border: 1px silver dashed;
    background-color: #F2F2F2;
    display: block;
    margin: 0.5em 0.5em 0.5em 0.5em;
    padding: 0.5em;
}
div.code-block.missing {
    background-color: #fa605254;
}
div.code-block code {display: block; white-space: pre-wrap; margin:0; padding:0; word-wrap: break-word;}
.emphasize { font-weight: 800;}
ul li, ol li {margin: 0.7em 0.2em;}
.float-right {float:right;}
.no-underline {    text-decoration :none;}
.top-links {font-size:20px; padding-left: 0.6em;}
.align-right {text-align: right;}
#footer hr {margin-top:1.5em;}
#footer p {margin-top:5px; padding-top:0; font-size: 9px;}
@font-face {
        font-family: "APLFont";
    src:
        local("APL385 Unicode"),
        url("https://misc.aplteam.com/apl385.ttf") format("truetype");
}
.info {border: 1px silver dashed; background-color: #F2F2F2;margin: 0.5em; padding: 0.5em;}
}
@media print{@page {size: portrait}
@page {
    margin: 1cm 1cm 1cm 1.75cm;
    @bottom-right {
        content: counter(page) " / " counter(pages);
  }
}
body {
    font: 12pt "Times New Roman", Times, serif;
    line-height: 1.2;
     /* CSS3 filter, at the moment Webkit only. Prefix it for future implementations */
    -webkit-filter: grayscale(100%);
    filter: grayscale(100%); /* future-proof */
}
h1 {font-size: 18pt;}
h2 {font-size: 16pt; margin-top: 10pt; margin-bottom: 3pt;}
th, td {padding: 2pt 3pt;}
th {text-align: left;background-color: #DBDBDB;}
tbody tr:nth-child(odd) {background-color: #EDEDED;}
table {
    color-adjust: exact !important;
    -webkit-print-color-adjust: exact !important;
    print-color-adjust: exact !important;
    font-size: 8pt;
    font-family: APLFont, monospace;
}
div.keep-together {break-inside: avoid; break-before:auto;}
table {border: silver 1pt solid;}
code , code a {font-size: 8pt; font-family: APLFont, monospace;}
code.header {
    font-size: 8pt;
    font-family: APLFont, monospace;
    margin: 7pt 3pt 0 10pt;
    padding:0;
    display: block;
}
div.code-block {
    border: 1pt silver dashed;
    background-color: #F2F2F2;
    display: block;
    margin: 4pt 4pt 4pt 4pt;
    padding: 4pt;
}
div.code-block code {display: block; white-space: pre-wrap; margin:0; padding:0; word-wrap: break-word;}
.emphasize { font-weight: 800;}
a {text-decoration: none;color: black;}
ul li, ol li {margin: 8pt 3pt;}
.no-print {display:none;}
.align-right {text-align: right;}
#footer hr {margin-top:1.5em;}
#footer p {margin-top:5pt; padding-top:0; font-size: 6pt;}
@font-face {
        font-family: "APLFont";
    src:
        local("APL385 Unicode"),
        url("https://misc.aplteam.com/apl385.ttf") format("truetype");
}
.info {border: 1px silver dashed; background-color: #F2F2F2;margin: 8px; padding: 8px;}
}
</style>
<link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/v/dt/jq-3.6.0/dt-1.11.2/b-2.0.0/b-print-2.0.0/fh-3.1.9/r-2.2.9/datatables.min.css"/>
<script type="text/javascript" src="https://cdn.datatables.net/v/dt/jq-3.6.0/dt-1.11.2/b-2.0.0/b-print-2.0.0/fh-3.1.9/r-2.2.9/datatables.min.js"></script>
</head>
<body>
<h1 id="top">Coverage Report</h1>
<p>Watched: 37 fns/opr within <code>⎕SE._tatin.aplteam_Snippets_0_5_2</code></p>
<p>The test suite was executed once:</p>
<table>
<thead>
<tr><th>Executed at</th><th>APLVersion</th><th>Memory (MB)</th></tr>
</thead>
<tbody>
<tr><td>2024-06-02 11:02:15</td><td>Windows-64 ⋄ 19.0.49376.0 ⋄ W ⋄ Development ⋄ Unicode</td><td>115</td></tr>
</tbody>
</table>
<p>Overall 41% of the testable code is covered.</p>
<p>(Comment lines, empty lines, all <code>:End</code>* lines etc. are ignored)</p>
<p>8 of the fns/opr are 100% covered.</p>
<div id="partly-covered" class="keep-together">
<table id="percent">
<thead>
<tr><th style="text-align:left;">Function/Operator</th><th style="text-align:left;">Lines not executed</th><th style="text-align:left;">Coverage</th><th style="text-align:right;">≢</th></tr>
</thead>
<tbody>
<tr class="uncovered"><td><a href="#listing_1" title="Link to listing">⎕SE._tatin.aplteam_Snippets_0_5_2.Compare_</a></td><td>1</td><td>0</td><td>1</td></tr>
<tr class="uncovered"><td><a href="#listing_2" title="Link to listing">⎕SE._tatin.aplteam_Snippets_0_5_2.Delete_</a></td><td>5←≢1-5</td><td>0</td><td>5</td></tr>
<tr class="uncovered"><td><a href="#listing_3" title="Link to listing">⎕SE._tatin.aplteam_Snippets_0_5_2.Edit_</a></td><td>15←≢1-5,7,9-16,18</td><td>0</td><td>15</td></tr>
<tr class="uncovered"><td><a href="#listing_4" title="Link to listing">⎕SE._tatin.aplteam_Snippets_0_5_2.EstablishCodeInNamespace</a></td><td>4←≢1-3,5</td><td>0</td><td>4</td></tr>
<tr class="uncovered"><td><a href="#listing_5" title="Link to listing">⎕SE._tatin.aplteam_Snippets_0_5_2.EstablishCodeSnippetInNamespace</a></td><td>1, 2</td><td>0</td><td>2</td></tr>
<tr class="uncovered"><td><a href="#listing_6" title="Link to listing">⎕SE._tatin.aplteam_Snippets_0_5_2.EstablishVarsInNamespace</a></td><td>1, 2</td><td>0</td><td>2</td></tr>
<tr class="uncovered"><td><a href="#listing_7" title="Link to listing">⎕SE._tatin.aplteam_Snippets_0_5_2.Extensions</a></td><td>1</td><td>0</td><td>1</td></tr>
<tr class="uncovered"><td><a href="#listing_8" title="Link to listing">⎕SE._tatin.aplteam_Snippets_0_5_2.GetCodeFromWS</a></td><td>6←≢1-4,6-7</td><td>0</td><td>6</td></tr>
<tr class="uncovered"><td><a href="#listing_9" title="Link to listing">⎕SE._tatin.aplteam_Snippets_0_5_2.GetNameAndBody</a></td><td>10←≢1-9,11</td><td>0</td><td>10</td></tr>
<tr class="uncovered"><td><a href="#listing_10" title="Link to listing">⎕SE._tatin.aplteam_Snippets_0_5_2.Help</a></td><td>116←≢1-31,33-34,36-116,118-119</td><td>0</td><td>116</td></tr>
<tr class="uncovered"><td><a href="#listing_11" title="Link to listing">⎕SE._tatin.aplteam_Snippets_0_5_2.Init</a></td><td>2, 3, 4</td><td>0</td><td>3</td></tr>
<tr class="uncovered"><td><a href="#listing_12" title="Link to listing">⎕SE._tatin.aplteam_Snippets_0_5_2.IsScripted</a></td><td>2, 3</td><td>0</td><td>2</td></tr>
<tr class="uncovered"><td><a href="#listing_13" title="Link to listing">⎕SE._tatin.aplteam_Snippets_0_5_2.Save_</a></td><td>60←≢1-5,7-8,11-14,16-21,24-25,27-39,41,44-45,47-48,50,52-56,58-59,61-66,68,70-71,73-74,76-77,79-80</td><td>0</td><td>60</td></tr>
<tr class="uncovered"><td><a href="#listing_14" title="Link to listing">⎕SE._tatin.aplteam_Snippets_0_5_2._</a></td><td>1</td><td>0</td><td>1</td></tr>
<tr class="uncovered"><td><a href="#listing_15" title="Link to listing">⎕SE._tatin.aplteam_Snippets_0_5_2.TatinVars.ASSETS</a></td><td>1</td><td>0</td><td>1</td></tr>
<tr class="uncovered"><td><a href="#listing_16" title="Link to listing">⎕SE._tatin.aplteam_Snippets_0_5_2.TatinVars.CONFIG</a></td><td>23←≢1-23</td><td>0</td><td>23</td></tr>
<tr class="uncovered"><td><a href="#listing_17" title="Link to listing">⎕SE._tatin.aplteam_Snippets_0_5_2.TatinVars.DEPENDENCIES</a></td><td>1</td><td>0</td><td>1</td></tr>
<tr class="uncovered"><td><a href="#listing_18" title="Link to listing">⎕SE._tatin.aplteam_Snippets_0_5_2.TatinVars.GetFullPath2AssetsFolder</a></td><td>4←≢1-4</td><td>0</td><td>4</td></tr>
<tr class="uncovered"><td><a href="#listing_19" title="Link to listing">⎕SE._tatin.aplteam_Snippets_0_5_2.TatinVars.HOME</a></td><td>9←≢2-10</td><td>0</td><td>9</td></tr>
<tr class="uncovered"><td><a href="#listing_20" title="Link to listing">⎕SE._tatin.aplteam_Snippets_0_5_2.TatinVars.ID</a></td><td>1</td><td>0</td><td>1</td></tr>
<tr class="uncovered"><td><a href="#listing_21" title="Link to listing">⎕SE._tatin.aplteam_Snippets_0_5_2.TatinVars.URI</a></td><td>1</td><td>0</td><td>1</td></tr>
<tr><td><a href="#listing_22" title="Link to listing">⎕SE._tatin.aplteam_Snippets_0_5_2.CutWidth</a></td><td>2, 3, 4</td><td>25</td><td>4</td></tr>
<tr><td><a href="#listing_23" title="Link to listing">⎕SE._tatin.aplteam_Snippets_0_5_2.Show_</a></td><td>9←≢8,13-18,20,22</td><td>50</td><td>18</td></tr>
<tr><td><a href="#listing_24" title="Link to listing">⎕SE._tatin.aplteam_Snippets_0_5_2.GetNameAndFilename</a></td><td>9←≢12-15,17,21,25-26,33</td><td>53</td><td>19</td></tr>
<tr><td><a href="#listing_25" title="Link to listing">⎕SE._tatin.aplteam_Snippets_0_5_2.Fix_</a></td><td>14←≢9,13,16,27-28,32,39,41-43,45,52,66,70</td><td>71</td><td>48</td></tr>
<tr><td><a href="#listing_26" title="Link to listing">⎕SE._tatin.aplteam_Snippets_0_5_2.CollectSnippetInfo</a></td><td>8←≢7,16,26,29,34-35,44-45</td><td>77</td><td>35</td></tr>
<tr><td><a href="#listing_27" title="Link to listing">⎕SE._tatin.aplteam_Snippets_0_5_2.Run</a></td><td>5←≢6,12,14,16,24</td><td>78</td><td>23</td></tr>
<tr><td><a href="#listing_28" title="Link to listing">⎕SE._tatin.aplteam_Snippets_0_5_2.Copy_</a></td><td>13, 14, 22</td><td>83</td><td>18</td></tr>
<tr><td><a href="#listing_29" title="Link to listing">⎕SE._tatin.aplteam_Snippets_0_5_2.List_</a></td><td>14, 19</td><td>91</td><td>23</td></tr>
<tr class="fullyCovered"><td><a href="#listing_30" title="Link to listing">⎕SE._tatin.aplteam_Snippets_0_5_2.Assert</a></td><td></td><td>100</td><td>0</td></tr>
<tr class="fullyCovered"><td><a href="#listing_31" title="Link to listing">⎕SE._tatin.aplteam_Snippets_0_5_2.GetCodeFromFile</a></td><td></td><td>100</td><td>8</td></tr>
<tr class="fullyCovered"><td><a href="#listing_32" title="Link to listing">⎕SE._tatin.aplteam_Snippets_0_5_2.GetComment</a></td><td></td><td>100</td><td>9</td></tr>
<tr class="fullyCovered"><td><a href="#listing_33" title="Link to listing">⎕SE._tatin.aplteam_Snippets_0_5_2.GetHomeFolder</a></td><td></td><td>100</td><td>2</td></tr>
<tr class="fullyCovered"><td><a href="#listing_34" title="Link to listing">⎕SE._tatin.aplteam_Snippets_0_5_2.GetNameFromBody</a></td><td></td><td>100</td><td>3</td></tr>
<tr class="fullyCovered"><td><a href="#listing_35" title="Link to listing">⎕SE._tatin.aplteam_Snippets_0_5_2.Help_</a></td><td></td><td>100</td><td>2</td></tr>
<tr class="fullyCovered"><td><a href="#listing_36" title="Link to listing">⎕SE._tatin.aplteam_Snippets_0_5_2.List</a></td><td></td><td>100</td><td>61</td></tr>
<tr class="fullyCovered"><td><a href="#listing_37" title="Link to listing">⎕SE._tatin.aplteam_Snippets_0_5_2.Version_</a></td><td></td><td>100</td><td>1</td></tr>
</tbody>
</table>
</div>
<script>
$(document).ready(function() {
    var oTable;
    oTable = $("#percent").DataTable( {
        paging:   false,
        ordering: true,
        info:     true,
        fixedHeader: true,
        order: [2,"asc"],
        dom: "Bft",
        drawCallback: function( settings ) {
             var api = this.api();
             $('.header[id^="listing_"]').next().addBack().css("display","none");
             api.rows( {page:"current"} ).data().each(function(data){
              id = data[0];
              id = id.match(/"(\#.*?)"/);
              if (id){$(id[1]).next().addBack().css("display","block");}
             })
        },      
        buttons: [
        {
            text: "Partly covered (8)",
            titleAttr: "50%",
            className: "active",
            action: function ( e, dt, node, config ) {
                var text = this.text();
                var search = "^(?!(0%|100%)).*";
                oTable.column(2)
                    .search(search,true,false,false)
                    .draw();
                $(".dt-buttons button").removeClass("active");
                this.active( true );
            }
        },
        {
            text: "Uncovered (21)",
            titleAttr: "0%",
            className: "active",
            action: function ( e, dt, node, config ) {
                var text = this.text();
                var search = "^0%";
                oTable.column(2)
                    .search(search,true,false,false)
                    .draw();
                $(".dt-buttons button").removeClass("active");
                this.active( true );
            }
        },
        {
            text: "Fully covered (8)",
            titleAttr: "100%",
            className: "active",
            action: function ( e, dt, node, config ) {
                var text = this.text();
                var search = "100%";
                oTable.column(2)
                    .search(search,true,false,false)
                    .draw();
                $(".dt-buttons button").removeClass("active");
                this.active( true );
            }
        },
        {
            text: "All (37)",
            titleAttr: "all",
            className: "active",
            action: function ( e, dt, node, config ) {
                var text = this.text();
                var search = ".";
                oTable.column(2)
                    .search(search,true,false,false)
                    .draw();
                $(".dt-buttons button").removeClass("active");
                this.active( true );
            }
        },
    ],
 
        columnDefs: [
            {className: "align-right", targets: [2,3]
            },
            {
                render: function ( data, type, row, meta ) {
                            return data+"%" ;        
                        },
                targets: 2
            }
        ]             
    } );
    oTable.button(0).trigger();

} );    
</script>
<h2>Listings</h2>
<code class="header" id="listing_1">⎕SE._tatin.aplteam_Snippets_0_5_2.Compare_ &mdash; 0%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> r←Compare_ ns</code>
<code class="emphasize">→[1]  r←'Sorry, not implemented yet'</code>
</div>
<code class="header" id="listing_2">⎕SE._tatin.aplteam_Snippets_0_5_2.Delete_ &mdash; 0%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> msg←sourceFile Delete_ ns</code>
<code class="emphasize">→[1]  txt←''ns.Switch ns._1</code>
<code class="emphasize">→[2]  (filenames snippetNames ind name msg)←CollectSnippetInfo'to be deleted'txt sourceFile</code>
<code class="emphasize">→[3]  :If 0&lt;≢name</code>
<code class="emphasize">→[4]      :If FilesAndDirs.DeleteFile ind⊃filenames</code>
<code class="emphasize">→[5]          msg←'Snippet deleted: ',name</code>
<code> [6]      :EndIf</code>
<code> [7]  :EndIf</code>
</div>
<code class="header" id="listing_3">⎕SE._tatin.aplteam_Snippets_0_5_2.Edit_ &mdash; 0%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  msg←sourceFile Edit_ ns</code>
<code class="emphasize">→[1]   (opCode msg name filename)←'SelectSnippetForEdit@Please select snippet to be edited'GetNameAndFilename ns</code>
<code class="emphasize">→[2]   :If 1=opCode</code>
<code class="emphasize">→[3]       (name body)←GetNameAndBody filename</code>
<code class="emphasize">→[4]       :If isCode←'.code'≡⎕C 3⊃⎕NPARTS filename</code>
<code class="emphasize">→[5]           ref←(2⊃⎕NPARTS filename)EstablishCodeSnippetInNamespace body</code>
<code> [6]       :Else</code>
<code class="emphasize">→[7]           ref←EstablishCodeInNamespace body</code>
<code> [8]       :EndIf</code>
<code class="emphasize">→[9]       ref.⎕ED name</code>
<code class="emphasize">→[10]      body2←isCode GetCodeFromWS ref name</code>
<code class="emphasize">→[11]      :If ≡/body body2</code>
<code class="emphasize">→[12]          msg←'No change detected'</code>
<code class="emphasize">→[13]      :ElseIf 0=≢(∊body2)~⎕UCS 10 13</code>
<code class="emphasize">→[14]          msg←'Cancelled by user' ⋄ →0</code>
<code class="emphasize">→[15]      :ElseIf CommTools.YesOrNo'Sure you want to save "',name,'" ?'</code>
<code class="emphasize">→[16]          (⊂body2)FilesAndDirs.NPUT filename 1</code>
<code> [17]      :Else</code>
<code class="emphasize">→[18]          msg←'Cancelled by user' ⋄ →0</code>
<code> [19]      :EndIf</code>
<code> [20]  :EndIf</code>
</div>
<code class="header" id="listing_4">⎕SE._tatin.aplteam_Snippets_0_5_2.EstablishCodeInNamespace &mdash; 0%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> ref←EstablishCodeInNamespace body</code>
<code class="emphasize">→[1]  ref←⎕NS''</code>
<code class="emphasize">→[2]  :If ∨/':class' ':namespace'{⍺≡(≢⍺)↑⍵}¨⊂⎕C' '~⍨⊃body</code>
<code class="emphasize">→[3]      ref.⎕FIX body</code>
<code> [4]  :Else</code>
<code class="emphasize">→[5]      ref.⎕FX body</code>
<code> [6]  :EndIf</code>
</div>
<code class="header" id="listing_5">⎕SE._tatin.aplteam_Snippets_0_5_2.EstablishCodeSnippetInNamespace &mdash; 0%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> ref←name EstablishCodeSnippetInNamespace value</code>
<code class="emphasize">→[1]  ref←⎕NS''</code>
<code class="emphasize">→[2]  ⍎'ref.',name,'←value'</code>
<code> [3] ⍝Done</code>
</div>
<code class="header" id="listing_6">⎕SE._tatin.aplteam_Snippets_0_5_2.EstablishVarsInNamespace &mdash; 0%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> ref←name EstablishVarsInNamespace value</code>
<code class="emphasize">→[1]  ref←⎕NS''</code>
<code class="emphasize">→[2]  ⍎'ref.',name,'←value'</code>
<code> [3] ⍝Done</code>
</div>
<code class="header" id="listing_7">⎕SE._tatin.aplteam_Snippets_0_5_2.Extensions &mdash; 0%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> r←Extensions</code>
<code class="emphasize">→[1]  r←'.aplf' '.aplo' '.aplc' '.apln' '.apli' '.dyalog' '.code'</code>
</div>
<code class="header" id="listing_8">⎕SE._tatin.aplteam_Snippets_0_5_2.GetCodeFromWS &mdash; 0%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> body←isCode GetCodeFromWS(ref name)</code>
<code class="emphasize">→[1]  :If isCode</code>
<code class="emphasize">→[2]      body←ref⍎name</code>
<code class="emphasize">→[3]  :ElseIf ref IsScripted name</code>
<code class="emphasize">→[4]      ∘∘∘  ⍝TODO⍝ Scripts are not yet supported</code>
<code> [5]  :Else</code>
<code class="emphasize">→[6]      body←↓ref.⎕CR name</code>
<code class="emphasize">→[7]      body←{⍵↓⍨-+/∧\' '=⌽⍵}¨body</code>
<code> [8]  :EndIf</code>
</div>
<code class="header" id="listing_9">⎕SE._tatin.aplteam_Snippets_0_5_2.GetNameAndBody &mdash; 0%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  (name body)←GetNameAndBody filename</code>
<code class="emphasize">→[1]   body←⊃⎕NGET filename 1</code>
<code class="emphasize">→[2]   body←(-+/∧\0=⌽≢¨body)↓body</code>
<code class="emphasize">→[3]   :Select ⎕C 3⊃⎕NPARTS filename</code>
<code class="emphasize">→[4]   :Case '.apla'</code>
<code class="emphasize">→[5]       name←2⊃⎕NPARTS filename ⍝ For a variable the filename defines the name</code>
<code class="emphasize">→[6]       body←⎕SE.Dyalog.Array.Deserialise body</code>
<code class="emphasize">→[7]   :Case '.code'</code>
<code class="emphasize">→[8]       name←2⊃⎕NPARTS filename ⍝ For a code snippted the filename defines the name</code>
<code class="emphasize">→[9]       body←∊body</code>
<code> [10]  :Else</code>
<code class="emphasize">→[11]      name←GetNameFromBody body</code>
<code> [12]  :EndSelect</code>
</div>
<code class="header" id="listing_10">⎕SE._tatin.aplteam_Snippets_0_5_2.Help &mdash; 0%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>   r←level Help Cmd</code>
<code class="emphasize">→[1]    r←''</code>
<code class="emphasize">→[2]    :Select level</code>
<code class="emphasize">→[3]    :Case 0</code>
<code class="emphasize">→[4]        :Select ⎕C Cmd</code>
<code class="emphasize">→[5]        :Case ⎕C'List'</code>
<code class="emphasize">→[6]            r,←⊂'List all saved snippets with the first comment line unless -short is specified'</code>
<code class="emphasize">→[7]            r,←⊂']Snippets.List [name*] -short -full'</code>
<code class="emphasize">→[8]        :Case ⎕C'Edit'</code>
<code class="emphasize">→[9]            r,←⊂'Edit a snippet'</code>
<code class="emphasize">→[10]           r,←⊂']Snippets.Edit [name*]'</code>
<code class="emphasize">→[11]       :Case ⎕C'Copy'</code>
<code class="emphasize">→[12]           r,←⊂'Copy a snippet to the clipboard (Windows only)'</code>
<code class="emphasize">→[13]           r,←⊂']Snippets.Copy [name*]'</code>
<code class="emphasize">→[14]       :Case ⎕C'Fix'</code>
<code class="emphasize">→[15]           r,←⊂'Fix a snippet in the workspace'</code>
<code class="emphasize">→[16]           r,←⊂']Snippets.Fix &lt;name&gt; -target='</code>
<code class="emphasize">→[17]       :Case ⎕C'Save'</code>
<code class="emphasize">→[18]           r,←⊂'Save a function or operator or script or a piece of code as a snippet'</code>
<code class="emphasize">→[19]           r,←⊂']Snippets.Save [name] -name='</code>
<code class="emphasize">→[20]       :Case ⎕C'Delete'</code>
<code class="emphasize">→[21]           r,←⊂'Delete a saved snippet'</code>
<code class="emphasize">→[22]           r,←⊂']Snippets.Delete [name*] -force'</code>
<code class="emphasize">→[23]       :Case ⎕C'Compare'</code>
<code class="emphasize">→[24]           r,←⊂'Compare a function, operator or script with a saved snippet'</code>
<code class="emphasize">→[25]           r,←⊂']Snippets.Compare &lt;object-name&gt;'</code>
<code class="emphasize">→[26]       :Case ⎕C'Show'</code>
<code class="emphasize">→[27]           r,←⊂'Bring the code of a snippet into ⎕ED'</code>
<code class="emphasize">→[28]           r,←⊂']Snippets.Show [&lt;name*&gt;] -session'</code>
<code class="emphasize">→[29]       :Case ⎕C'Version'</code>
<code class="emphasize">→[30]           r,←⊂'Return the version number of the snippet manager'</code>
<code class="emphasize">→[31]           r,←⊂']Snippets.Version'</code>
<code> [32]       :EndSelect</code>
<code class="emphasize">→[33]       :If ~(⊂⎕C Cmd)∊⎕C'Version' 'Help'</code>
<code class="emphasize">→[34]           r,←''(']Cider.',Cmd,' -?? ⍝ Enter this for more information ')</code>
<code> [35]       :EndIf</code>
<code class="emphasize">→[36]   :Case 1</code>
<code class="emphasize">→[37]       :Select ⎕C Cmd</code>
<code class="emphasize">→[38]       :Case ⎕C'List'</code>
<code class="emphasize">→[39]           r,←⊂'Lists all saved snippets with the first comment line unless -short is specified.'</code>
<code class="emphasize">→[40]           r,←⊂'In case -full is specified the full filename rather than just the snippet name is shown.'</code>
<code class="emphasize">→[41]           r,←⊂''</code>
<code class="emphasize">→[42]           r,←⊂'* If no name is given all snippets are listed'</code>
<code class="emphasize">→[43]           r,←⊂'* If something is specified all snippets that start with the argument are listed'</code>
<code class="emphasize">→[44]           r,←⊂'  The search is not case sensitive.'</code>
<code class="emphasize">→[45]           r,←⊂'* In case -short is specified only the names are listed but no comments'</code>
<code class="emphasize">→[46]       :Case ⎕C'Edit'</code>
<code class="emphasize">→[47]           r,←⊂'Allows you to edit a snippet as if it were a variable in the workspace.'</code>
<code class="emphasize">→[48]           r,←⊂''</code>
<code class="emphasize">→[49]           r,←⊂'* If no argument is specified all snippets are listed and you may select one'</code>
<code class="emphasize">→[50]           r,←⊂'* If an argument is specified but carries a trailing asterisk all snippets with'</code>
<code class="emphasize">→[51]           r,←⊂'  corresponding names are listed. The search is not case sensitive.'</code>
<code class="emphasize">→[52]           r,←⊂'* If an argument is specified without a trailing asterisk the name given must match a'</code>
<code class="emphasize">→[53]           r,←⊂'  snippet, otherwise an error is signalled. The search is not case sensitive.'</code>
<code class="emphasize">→[54]       :Case ⎕C'Copy'</code>
<code class="emphasize">→[55]           r,←⊂'Copies a snippet to the clipboard (Windows only)'</code>
<code class="emphasize">→[56]           r,←⊂''</code>
<code class="emphasize">→[57]           r,←⊂'* If no argument is specified, all snippets are listed, and the user may select one'</code>
<code class="emphasize">→[58]           r,←⊂'* If an argument is specified but carries a trailing asterisk, all snippets with'</code>
<code class="emphasize">→[59]           r,←⊂'  corresponding names are listed for selection. The search is not case sensitive.'</code>
<code class="emphasize">→[60]           r,←⊂'* If an argument is specified without a trailing asterisk, a snippet with that name'</code>
<code class="emphasize">→[61]           r,←⊂'  will be copied. The search is not case sensitive.'</code>
<code class="emphasize">→[62]       :Case ⎕C'Fix'</code>
<code class="emphasize">→[63]           r,←⊂'Fixes a snippet into the workspace'</code>
<code class="emphasize">→[64]           r,←⊂''</code>
<code class="emphasize">→[65]           r,←⊂'* If no argument is specified all snippets are listed except those stored in .code'</code>
<code class="emphasize">→[66]           r,←⊂'  files: they cannot be fixed by definition. The user can then select one of them.'</code>
<code class="emphasize">→[67]           r,←⊂'* If an argument is specified but carries a trailing asterisk all snippets with'</code>
<code class="emphasize">→[68]           r,←⊂'  corresponding names are listed for selection. The search is not case sensitive.'</code>
<code class="emphasize">→[69]           r,←⊂'* If an argument is specified without a trailing asterisk a snippet with that name'</code>
<code class="emphasize">→[70]           r,←⊂'  will be fixed. The search is not case sensitive.'</code>
<code class="emphasize">→[71]           r,←⊂'  If no snippet is found an error is signalled.'</code>
<code class="emphasize">→[72]           r,←⊂'* If -target is not specified the snipped will be fixed in # unless the user is'</code>
<code class="emphasize">→[73]           r,←⊂'  currently in a sub-namespace of #, when the user will be asked what to do.'</code>
<code class="emphasize">→[74]       :Case ⎕C'Save'</code>
<code class="emphasize">→[75]           r,←⊂'Saves a function or operator or script or some text as a snippet'</code>
<code class="emphasize">→[76]           r,←⊂''</code>
<code class="emphasize">→[77]           r,←⊂'* If an argument is specified, it is interpreted as a fully qualified name to the'</code>
<code class="emphasize">→[78]           r,←⊂'  function, operator, script or piece of text to be saved'</code>
<code class="emphasize">→[79]           r,←⊂'* By default the name of the APL object defines the name of the snippet'</code>
<code class="emphasize">→[80]           r,←⊂'* With the -name= option you can specify a different name'</code>
<code class="emphasize">→[81]           r,←⊂'* If no argument is specified at all and there is text on the clipboard, the user'</code>
<code class="emphasize">→[82]           r,←⊂'  command assumes that you want to save the clipboard content as a snippet.'</code>
<code class="emphasize">→[83]           r,←⊂'  In this case a confirmation is required.'</code>
<code class="emphasize">→[84]       :Case ⎕C'Delete'</code>
<code class="emphasize">→[85]           r,←⊂'Deletes a saved snippet'</code>
<code class="emphasize">→[86]           r,←⊂''</code>
<code class="emphasize">→[87]           r,←⊂'* When an argument is specified any matching snippet will be deleted. The search will'</code>
<code class="emphasize">→[88]           r,←⊂'  not be case sensitive. If the argument carries a trailing asterisk all matching'</code>
<code class="emphasize">→[89]           r,←⊂'  snippets will be presented for selection.'</code>
<code class="emphasize">→[90]           r,←⊂'* The user must always confirm a delete operation except when -force is specified'</code>
<code class="emphasize">→[91]           r,←⊂'* When no argument is specified all snippets will be presented for selection'</code>
<code class="emphasize">→[92]           r,←⊂'* -force has no effect in case the user is presented a list with more than one snippet'</code>
<code class="emphasize">→[93]       :Case ⎕C'Compare'</code>
<code class="emphasize">→[94]           r,←⊂'Compares a function, operator or script with a saved snippet'</code>
<code class="emphasize">→[95]           r,←⊂''</code>
<code class="emphasize">→[96]           r,←⊂'This command requires at least one argument and accepts up to two.'</code>
<code class="emphasize">→[97]           r,←⊂''</code>
<code class="emphasize">→[98]           r,←⊂'* A single argument is interpreted as the name of an APL object. If it is not fully'</code>
<code class="emphasize">→[99]           r,←⊂'  qualified it is assumed to live in the namespace the user command was called from.'</code>
<code class="emphasize">→[100]          r,←⊂'* A second argument must be the name of a snippet. If this is not specified the user'</code>
<code class="emphasize">→[101]          r,←⊂'  will be presented a list withh all snippets for selection.'</code>
<code class="emphasize">→[102]          r,←⊂'* If the second argument carries a trailing asterisk all matching snippets will be'</code>
<code class="emphasize">→[103]          r,←⊂'  presented for selection. The search will not be case sensitive.'</code>
<code class="emphasize">→[104]          r,←⊂'* If the user command ]CompareFiles (and its API) is available this will be used to'</code>
<code class="emphasize">→[105]          r,←⊂'  carry out the comparison, otherwise two files are printed to the session.'</code>
<code class="emphasize">→[106]          r,←⊂''</code>
<code class="emphasize">→[107]      :Case ⎕C'Show'</code>
<code class="emphasize">→[108]          r,←⊂'Brings the code of a given snippet into ⎕ED.'</code>
<code class="emphasize">→[109]          r,←⊂''</code>
<code class="emphasize">→[110]          r,←⊂'If a given name does not result in a match it is interpreted as "search for all that'</code>
<code class="emphasize">→[111]          r,←⊂'start with the given string". If several snippets match the user is given a list to'</code>
<code class="emphasize">→[112]          r,←⊂'select from. The search is case insensitive.'</code>
<code class="emphasize">→[113]          r,←⊂''</code>
<code class="emphasize">→[114]          r,←⊂'-session Prints the code to the session rather than bringing it into ⎕ED'</code>
<code class="emphasize">→[115]      :Case ⎕C'Version'</code>
<code class="emphasize">→[116]          r,←⊂'Returns the version number of the ]Snippets user command'</code>
<code> [117]      :EndSelect</code>
<code class="emphasize">→[118]  :Case 2</code>
<code class="emphasize">→[119]      r,←⊂'There is no additional help available'</code>
<code> [120]  :EndSelect</code>
</div>
<code class="header" id="listing_11">⎕SE._tatin.aplteam_Snippets_0_5_2.Init &mdash; 0%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> Init</code>
<code> [1] ⍝ Initialize the "Snippets" project</code>
<code class="emphasize">→[2]  :If 0=⎕SE.⎕NC'Snippets.DEVELOPMENT'</code>
<code class="emphasize">→[3]  :AndIf 1 CommTools.YesOrNo'Set DEVELOPMENT←1 in ⎕SE.Snippets? (Allows executing user command code in # rather than ⎕SE)'</code>
<code class="emphasize">→[4]      ⎕SE.Snippets.DEVELOPMENT←1</code>
<code> [5]  :EndIf</code>
<code> [6]  ⍝Done</code>
</div>
<code class="header" id="listing_12">⎕SE._tatin.aplteam_Snippets_0_5_2.IsScripted &mdash; 0%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> r←{x}IsScripted y</code>
<code> [1] ⍝ Returns a 1 for classes, interfaces and scripted namespaces and 0 otherwise.</code>
<code class="emphasize">→[2]  ref←{0&lt;⎕NC'x':⍎⍵ ⋄ ⎕THIS}'x'</code>
<code class="emphasize">→[3]  r←ref.{11 16::0 ⋄ 1⊣⎕SRC ⍵}y</code>
</div>
<code class="header" id="listing_13">⎕SE._tatin.aplteam_Snippets_0_5_2.Save_ &mdash; 0%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  msg←Save_ ns</code>
<code class="emphasize">→[1]   :If 0=≢ns.Arguments</code>
<code class="emphasize">→[2]       'cl'⎕WC'Clipboard'</code>
<code class="emphasize">→[3]       body←⊆cl.Text</code>
<code class="emphasize">→[4]       :If 0=≢name←''ns.Switch'name'</code>
<code class="emphasize">→[5]           name←({ns←⎕NS'' ⋄ 0=ns.⎕NC ⍵:1 ⋄ ⎕←'Please enter a valid APL name' ⋄ 0}CommTools.AskForText)'name@Specify the name of the snippet'</code>
<code> [6]       :EndIf</code>
<code class="emphasize">→[7]       :If 0=≢name</code>
<code class="emphasize">→[8]           msg←'Cancelled by user' ⋄ →0</code>
<code> [9]       :EndIf</code>
<code> [10]  :Else</code>
<code class="emphasize">→[11]      name←ns._1</code>
<code class="emphasize">→[12]      :If '.'∊name</code>
<code class="emphasize">→[13]          parent←{⍵↓⍨-'.'⍳⍨⌽⍵}name</code>
<code class="emphasize">→[14]          ('Object not found',name)Assert 0&lt;≢parent</code>
<code> [15]      :Else</code>
<code class="emphasize">→[16]          parent←⊃{⍵/⍨~'['∊¨⍵}{⍵↓⍨+/∧\'⎕se'∘≡¨3↑¨⎕C ⍵}⎕NSI</code>
<code class="emphasize">→[17]          nc←(⍎parent).⎕NC name</code>
<code class="emphasize">→[18]          :If nc=¯1</code>
<code class="emphasize">→[19]              msg←'Invalid snippet name' ⋄ →0</code>
<code class="emphasize">→[20]          :ElseIf nc=0</code>
<code class="emphasize">→[21]              msg←'Name has no value?!' ⋄ →0</code>
<code> [22]          :EndIf</code>
<code> [23]      :EndIf</code>
<code class="emphasize">→[24]      :If ~(⊂,1 ⎕C parent)∊,¨'#' '⎕SE'</code>
<code class="emphasize">→[25]          ('Parent object not found: ',parent)Assert 9=⎕NC parent</code>
<code> [26]      :EndIf</code>
<code class="emphasize">→[27]      parent←⍎parent</code>
<code class="emphasize">→[28]      :Select ⊃parent.⎕NC name</code>
<code class="emphasize">→[29]      :Case ¯1</code>
<code class="emphasize">→[30]          ('Name &lt;',name,'&gt; is invalid')⎕SIGNAL 6</code>
<code class="emphasize">→[31]      :Case 0</code>
<code class="emphasize">→[32]          ('&lt;',name,'&gt; not found in ',⍕parent)⎕SIGNAL 6</code>
<code class="emphasize">→[33]      :Case 2</code>
<code class="emphasize">→[34]          body←parent⍎ns._1</code>
<code class="emphasize">→[35]          body←⎕SE.Dyalog.Array.Serialise body</code>
<code class="emphasize">→[36]      :Case 9</code>
<code class="emphasize">→[37]          body←⎕SRC parent⍎name</code>
<code class="emphasize">→[38]      :CaseList 3 4</code>
<code class="emphasize">→[39]          body←parent.⎕NR name</code>
<code> [40]      :Else</code>
<code class="emphasize">→[41]          ∘∘∘  ⍝ Huh?!</code>
<code> [42]      :EndSelect</code>
<code> [43]  :EndIf</code>
<code class="emphasize">→[44]  :If 0=≢body</code>
<code class="emphasize">→[45]      msg←'No name was specified, and the clipboard does not contain code?!'</code>
<code> [46]  :Else</code>
<code class="emphasize">→[47]      :If 0≠⎕NC'parent'</code>
<code class="emphasize">→[48]          nc←parent.⎕NC name</code>
<code> [49]      :Else</code>
<code class="emphasize">→[50]          nc←0</code>
<code> [51]      :EndIf</code>
<code class="emphasize">→[52]      :If nc∊2 3 4</code>
<code class="emphasize">→[53]          extension←(2 3 4⍳nc)⊃'.apla' '.aplf' '.aplo'</code>
<code class="emphasize">→[54]      :ElseIf nc=0</code>
<code class="emphasize">→[55]          extension←'.code'</code>
<code class="emphasize">→[56]          body←∊body</code>
<code> [57]      :Else</code>
<code class="emphasize">→[58]          nc←parent.⎕NC⊂name</code>
<code class="emphasize">→[59]          extension←(9.1 9.4 9.5⍳nc)⊃'.apln' '.aplc' '.apli'</code>
<code> [60]      :EndIf</code>
<code class="emphasize">→[61]      name_←{⍵↑⍨-¯1+'.'⍳⍨⌽⍵}name</code>
<code class="emphasize">→[62]      filename←(GetHomeFolder 1⊃⎕NPARTS sourceFile),name_,extension</code>
<code class="emphasize">→[63]      :If FilesAndDirs.IsFile filename</code>
<code class="emphasize">→[64]          q←'The file already exists - overwrite?'</code>
<code class="emphasize">→[65]          :If CommTools.YesOrNo q</code>
<code class="emphasize">→[66]              FilesAndDirs.DeleteFile filename</code>
<code> [67]          :Else</code>
<code class="emphasize">→[68]              msg←'Cancelled by user' ⋄ →0</code>
<code> [69]          :EndIf</code>
<code class="emphasize">→[70]      :ElseIf FilesAndDirs.IsDir filename</code>
<code class="emphasize">→[71]          msg←'Cannot continue: ',filename,' is a directory' ⋄ →0</code>
<code> [72]      :EndIf</code>
<code class="emphasize">→[73]      :Trap 0</code>
<code class="emphasize">→[74]          ref←name_{ns←⎕NS'' ⋄ _←⍎'ns.',⍺,'←,/⍵,¨⎕UCS 10' ⋄ ns}body</code>
<code> [75]      :Else</code>
<code class="emphasize">→[76]          qdmx←⎕DMX</code>
<code class="emphasize">→[77]          msg←qdmx.EM{0=≢⍵:⍺ ⋄ ⍵}qdmx.Message ⋄ →0</code>
<code> [78]      :EndTrap</code>
<code class="emphasize">→[79]      (⊂body)FilesAndDirs.NPUT filename</code>
<code class="emphasize">→[80]      msg←'Code snippet successfully saved as ',⊃,/1↓⎕NPARTS filename</code>
<code> [81]  :EndIf</code>
</div>
<code class="header" id="listing_14">⎕SE._tatin.aplteam_Snippets_0_5_2._ &mdash; 0%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> r←_ ns</code>
<code class="emphasize">→[1]  r←{{⍵↑⍨¯1+⌊/⍵⍳'+"'}1↓⍵/⍨{⍵∨≠\⍵}⍵='"'}{⍵⊃⍨1⍳⍨∨/¨'version:'∘⍷¨⍵}(⎕UCS 13)(≠⊆⊢)TatinVars.CONFIG</code>
</div>
<code class="header" id="listing_15">⎕SE._tatin.aplteam_Snippets_0_5_2.TatinVars.ASSETS &mdash; 0%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> r←ASSETS</code>
<code class="emphasize">→[1]  r←''</code>
</div>
<code class="header" id="listing_16">⎕SE._tatin.aplteam_Snippets_0_5_2.TatinVars.CONFIG &mdash; 0%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  r←CONFIG</code>
<code class="emphasize">→[1]   r←'{</code>
<code class="emphasize">→[2]    api: "",</code>
<code class="emphasize">→[3]    assets: "",</code>
<code class="emphasize">→[4]    description: "Manage APL-code snippets",</code>
<code class="emphasize">→[5]    documentation: "",</code>
<code class="emphasize">→[6]    files: "",</code>
<code class="emphasize">→[7]    group: "aplteam",</code>
<code class="emphasize">→[8]    io: 1,</code>
<code class="emphasize">→[9]    license: "MIT",</code>
<code class="emphasize">→[10]   lx: "",</code>
<code class="emphasize">→[11]   maintainer: "kai@aplteam.com",</code>
<code class="emphasize">→[12]   minimumAplVersion: "18.0",</code>
<code class="emphasize">→[13]   ml: 1,</code>
<code class="emphasize">→[14]   name: "Snippets",</code>
<code class="emphasize">→[15]   os_lin: 1,</code>
<code class="emphasize">→[16]   os_mac: 1,</code>
<code class="emphasize">→[17]   os_win: 1,</code>
<code class="emphasize">→[18]   project_url: "https://github.com/aplteam/Snippets",</code>
<code class="emphasize">→[19]   source: "APLSource/Snippets",</code>
<code class="emphasize">→[20]   tags: "code-snippets",</code>
<code class="emphasize">→[21]   uri: "C://T//Projects//UserCommands//Snippets//Dist//aplteam-Snippets-0.5.2.zip",</code>
<code class="emphasize">→[22]   userCommandScript: "APLSource/Snippets_UC.dyalog",</code>
<code class="emphasize">→[23]   version: "0.5.2+76",</code>
<code> [24] }'</code>
</div>
<code class="header" id="listing_17">⎕SE._tatin.aplteam_Snippets_0_5_2.TatinVars.DEPENDENCIES &mdash; 0%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> r←DEPENDENCIES</code>
<code class="emphasize">→[1]  r←,⊆'aplteam-FilesAndDirs-5.7.1' 'aplteam-CommTools-1.7.1' 'aplteam-APLTreeUtils2-1.4.0'</code>
</div>
<code class="header" id="listing_18">⎕SE._tatin.aplteam_Snippets_0_5_2.TatinVars.GetFullPath2AssetsFolder &mdash; 0%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> r←GetFullPath2AssetsFolder</code>
<code class="emphasize">→[1]  :If 0&lt;≢r←ASSETS</code>
<code class="emphasize">→[2]  :AndIf 0&lt;≢HOME</code>
<code class="emphasize">→[3]  :AndIf ⎕NEXISTS HOME</code>
<code class="emphasize">→[4]      r←HOME,'/',ASSETS</code>
<code> [5]  :EndIf</code>
</div>
<code class="header" id="listing_19">⎕SE._tatin.aplteam_Snippets_0_5_2.TatinVars.HOME &mdash; 0%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  r←HOME</code>
<code> [1]  ⍝ Returns folder package was loaded from or current directory or an empty vector if both are not valid</code>
<code class="emphasize">→[2]   ⎕IO←1 ⋄ ⎕ML←1</code>
<code class="emphasize">→[3]   r←'C:\Users\kai\Documents\MyUCMDs\Snippets/aplteam-Snippets-0.5.2'   ⍝ Original source</code>
<code class="emphasize">→[4]   :If ~⎕NEXISTS r</code>
<code class="emphasize">→[5]       (dir name extension)←⎕NPARTS r</code>
<code class="emphasize">→[6]       r←(⊃1 ⎕NPARTS''),(2⊃⎕NPARTS ¯1↓dir),'/',name,extension ⍝ Try current dir</code>
<code class="emphasize">→[7]   :AndIf ~⎕NEXISTS r</code>
<code class="emphasize">→[8]       r←(⊃1 ⎕NPARTS''),name,extension</code>
<code class="emphasize">→[9]   :AndIf ~⎕NEXISTS r</code>
<code class="emphasize">→[10]      r←''</code>
<code> [11]  :EndIf</code>
</div>
<code class="header" id="listing_20">⎕SE._tatin.aplteam_Snippets_0_5_2.TatinVars.ID &mdash; 0%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> r←ID</code>
<code class="emphasize">→[1]  r←'aplteam-Snippets-0.5.2+76'</code>
</div>
<code class="header" id="listing_21">⎕SE._tatin.aplteam_Snippets_0_5_2.TatinVars.URI &mdash; 0%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> r←URI</code>
<code class="emphasize">→[1]  r←'C://T//Projects//UserCommands//Snippets//Dist//aplteam-Snippets-0.5.2.zip'</code>
</div>
<code class="header" id="listing_22">⎕SE._tatin.aplteam_Snippets_0_5_2.CutWidth &mdash; 25%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> r←CutWidth r</code>
<code> [1]  :If ⎕PW&lt;1+2⊃⍴r</code>
<code class="emphasize">→[2]      rows←⍸∨/' '≠⎕PW↓[2]r</code>
<code class="emphasize">→[3]      r[rows;(⎕PW-3)+⍳3]←'.'</code>
<code class="emphasize">→[4]      r←⎕PW↑[2]r</code>
<code> [5]  :EndIf</code>
</div>
<code class="header" id="listing_23">⎕SE._tatin.aplteam_Snippets_0_5_2.Show_ &mdash; 50%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  r←sourceFile Show_ ns</code>
<code> [1]   r←''</code>
<code> [2]   (opCode r name filename)←'SelectSnippetForView@Please select snippet to be shown with ⎕ED'GetNameAndFilename ns</code>
<code> [3]   :If 1=opCode</code>
<code> [4]       session←ns.Switch'session'</code>
<code> [5]       :If session</code>
<code> [6]           r←⊃FilesAndDirs.NGET filename 1</code>
<code> [7]           :If '.apla'≡3⊃⎕NPARTS filename</code>
<code class="emphasize">→[8]               r←⎕SE.Dyalog.Array.Deserialise r</code>
<code> [9]           :EndIf</code>
<code> [10]          r←⍪↓APLTreeUtils2.DLB↑r</code>
<code> [11]          r←(⊂(⎕PW-5)⍴'-')⍪r</code>
<code> [12]      :Else</code>
<code class="emphasize">→[13]          (name body)←2↑GetNameAndBody filename</code>
<code class="emphasize">→[14]          :Select ⎕C 3⊃⎕NPARTS filename</code>
<code class="emphasize">→[15]          :Case '.apla'</code>
<code class="emphasize">→[16]              ref←name EstablishVarsInNamespace body</code>
<code class="emphasize">→[17]          :Case '.code'</code>
<code class="emphasize">→[18]              ref←name EstablishCodeSnippetInNamespace body</code>
<code> [19]          :Else</code>
<code class="emphasize">→[20]              ref←EstablishCodeInNamespace body</code>
<code> [21]          :EndSelect</code>
<code class="emphasize">→[22]          ref.{{}(⎕ED⍠('ReadOnly' 1)&amp;⍵)}name</code>
<code> [23]      :EndIf</code>
<code> [24]  :EndIf</code>
</div>
<code class="header" id="listing_24">⎕SE._tatin.aplteam_Snippets_0_5_2.GetNameAndFilename &mdash; 53%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  (opCode msg name filename)←caption GetNameAndFilename ns</code>
<code> [1]  ⍝ opCodes:</code>
<code> [2]  ⍝  0 = nothing to do (for example, no snippets found)</code>
<code> [3]  ⍝  1 = All fine, carry on</code>
<code> [4]  ⍝ ¯1 = Snippet not found</code>
<code> [5]  ⍝ ¯2 = Cancelled by user</code>
<code> [6]   msg←name←filename←''</code>
<code> [7]   :If 0&lt;≢list←FilesAndDirs.ListFiles GetHomeFolder sourceFile,'/..'</code>
<code> [8]       list2←{2⊃⎕NPARTS ⍵}¨list</code>
<code> [9]       name←{0≡⍵:'' ⋄ ⍵}ns._1</code>
<code> [10]      :If 0&lt;≢name</code>
<code> [11]          :If '*'∊name</code>
<code class="emphasize">→[12]              ind←⍸(name~'*'){(⎕C ⍺)∘≡¨⎕C(≢⍺)↑¨⍵}list2</code>
<code class="emphasize">→[13]              :If 1&lt;≢ind</code>
<code class="emphasize">→[14]                  :If 0=≢ind2←caption CommTools.Select list2[ind]</code>
<code class="emphasize">→[15]                      msg←'Cancelled by user' ⋄ opCode←¯2 ⋄ →0</code>
<code> [16]                  :EndIf</code>
<code class="emphasize">→[17]                  ind←ind[ind2]</code>
<code> [18]              :EndIf</code>
<code> [19]          :Else</code>
<code> [20]              :If 0=≢ind←⍸(⎕C list2)≡¨⊂⎕C name</code>
<code class="emphasize">→[21]                  msg←'Snippet not found' ⋄ opCode←¯1 ⋄ →0</code>
<code> [22]              :EndIf</code>
<code> [23]          :EndIf</code>
<code> [24]      :Else</code>
<code class="emphasize">→[25]          :If 0=≢ind←caption CommTools.Select list2</code>
<code class="emphasize">→[26]              msg←'Cancelled by user' ⋄ opCode←¯2 ⋄ →0</code>
<code> [27]          :EndIf</code>
<code> [28]      :EndIf</code>
<code> [29]      name←ind⊃list2</code>
<code> [30]      filename←ind⊃list</code>
<code> [31]      opCode←1</code>
<code> [32]  :Else</code>
<code class="emphasize">→[33]      msg←'No snippets found' ⋄ opCode←0 ⋄</code>
<code> [34]  :EndIf</code>
</div>
<code class="header" id="listing_25">⎕SE._tatin.aplteam_Snippets_0_5_2.Fix_ &mdash; 71%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  msg←sourceFile Fix_ ns</code>
<code> [1]   (filenames snippetNames ind name msg)←0 CollectSnippetInfo'to fix in the workspace'({0≡⍵:'' ⋄ ⍵}ns._1)sourceFile</code>
<code> [2]   :If 'Cancelled by user'≢msg</code>
<code> [3]       parent←''ns.Switch'target'</code>
<code> [4]       :If 0&lt;≢name</code>
<code> [5]           :If 0=≢parent</code>
<code> [6]               :If (,'#')≢parent←⊃{⍵/⍨~'['∊¨⍵}{⍵↓⍨+/∧\'⎕se'∘≡¨3↑¨⎕C ⍵}⎕NSI</code>
<code> [7]                   index←'WhereToFix@Where do you want to fix it:'CommTools.Select(⊂,'#'),⊂parent</code>
<code> [8]                   :If 0=≢index</code>
<code class="emphasize">→[9]                       msg←'Cancelled by user' ⋄ →0</code>
<code> [10]                  :EndIf</code>
<code> [11]                  parent←⍎index⊃'#'parent</code>
<code> [12]              :Else</code>
<code class="emphasize">→[13]                  parent←#</code>
<code> [14]              :EndIf</code>
<code> [15]          :Else</code>
<code class="emphasize">→[16]              parent←⍎parent</code>
<code> [17]          :EndIf</code>
<code> [18]          body←GetCodeFromFile ind⊃filenames</code>
<code> [19]          extension←3⊃⎕NPARTS ind⊃filenames</code>
<code> [20]          :If isVars←'.apla'≡extension</code>
<code> [21]              name←2⊃⎕NPARTS ind⊃filenames</code>
<code> [22]          :Else</code>
<code> [23]              body←{2=⍴⍴⍵:⍵ ⋄ ,⊆⍵}body</code>
<code> [24]              :Trap 0</code>
<code> [25]                  name←GetNameFromBody body</code>
<code> [26]              :Else</code>
<code class="emphasize">→[27]                  qdmx←⎕DMX</code>
<code class="emphasize">→[28]                  qdmx.EM ⎕SIGNAL qdmx.EN</code>
<code> [29]              :EndTrap</code>
<code> [30]              :If name≢2⊃⎕NPARTS ind⊃filenames</code>
<code> [31]              :AndIf ~CommTools.YesOrNo'DifferentName@Will be fixed as "',name,'"; you okay with that?'</code>
<code class="emphasize">→[32]                  msg←'Cancelled by user' ⋄ →0</code>
<code> [33]              :EndIf</code>
<code> [34]          :EndIf</code>
<code> [35]          :Select ⊃parent.⎕NC name</code>
<code> [36]          :Case 0</code>
<code> [37]               ⍝ Name is okay and not in use, nothing to do</code>
<code> [38]          :Case ¯1</code>
<code class="emphasize">→[39]              ('Invalid name: ',name)⎕SIGNAL 11</code>
<code> [40]          :Else</code>
<code class="emphasize">→[41]              q←'"',name,'" already used in ',(⍕parent),'; overwrite?'</code>
<code class="emphasize">→[42]              :If 0=CommTools.YesOrNo q</code>
<code class="emphasize">→[43]                  msg←'Cancelled by user' ⋄ →0</code>
<code> [44]              :EndIf</code>
<code class="emphasize">→[45]              parent.⎕EX name</code>
<code> [46]          :EndSelect</code>
<code> [47]          :If (⊂extension)∊'.aplf' '.aplo'</code>
<code> [48]              buff←parent.⎕FX body</code>
<code> [49]              :If ' '=1↑0⍴∊buff</code>
<code> [50]                  msg←'Function "',name,'" fixed in ',⍕parent</code>
<code> [51]              :Else</code>
<code class="emphasize">→[52]                  msg←'Attempt to fix "',name,'" caused an error in line ',⍕buff</code>
<code> [53]              :EndIf</code>
<code> [54]              res←⎕SE.Link.Add(⍕parent),'.',name</code>
<code> [55]              :If 'Added:'{⍺≡(≢⍺)↑⍵}res</code>
<code> [56]                  msg,←'; ',res</code>
<code> [57]              :EndIf</code>
<code> [58]          :ElseIf isVars</code>
<code> [59]              ⍎(⍕parent),'.',name,'←body'</code>
<code> [60]              msg←'Variable "',name,'" assigned in "',(⍕parent),'"'</code>
<code> [61]          :Else</code>
<code> [62]              :Trap 0</code>
<code> [63]                  {}parent.⎕FIX body</code>
<code> [64]                  msg←'Script "',name,'" fixed in ',⍕parent</code>
<code> [65]              :Else</code>
<code class="emphasize">→[66]                  msg←'Attempt to fix "',name,'" caused an error'</code>
<code> [67]              :EndTrap</code>
<code> [68]          :EndIf</code>
<code> [69]      :Else</code>
<code class="emphasize">→[70]          msg←'No such (fixable) snippet found'</code>
<code> [71]      :EndIf</code>
<code> [72]  :EndIf</code>
</div>
<code class="header" id="listing_26">⎕SE._tatin.aplteam_Snippets_0_5_2.CollectSnippetInfo &mdash; 77%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  (filenames snippetNames ind name msg)←{all}CollectSnippetInfo y</code>
<code> [1]   all←{0&lt;⎕NC ⍵:⍎⍵ ⋄ 1}'all'</code>
<code> [2]   (caption txt sourceFile)←3↑y,⊂''</code>
<code> [3]   snippetNames←msg←''</code>
<code> [4]   folder←GetHomeFolder sourceFile,'/..'</code>
<code> [5]   filenames←FilesAndDirs.ListFiles folder</code>
<code> [6]   :If 0=≢filenames</code>
<code class="emphasize">→[7]       msg←'No ',((~all)/'fixable'),' snippets found' ⋄ →0</code>
<code> [8]   :EndIf</code>
<code> [9]   :If all</code>
<code> [10]      bool←1</code>
<code> [11]  :Else</code>
<code> [12]      bool←'.code'∘≢¨3⊃∘⎕NPARTS¨filenames</code>
<code> [13]      filenames←bool/filenames</code>
<code> [14]  :EndIf</code>
<code> [15]  :If 0=≢filenames</code>
<code class="emphasize">→[16]      msg←'No ',((~all)/'fixable'),' snippets found' ⋄ →0</code>
<code> [17]  :EndIf</code>
<code> [18]  snippetNames←2⊃∘⎕NPARTS¨filenames</code>
<code> [19]  name←''</code>
<code> [20]  :If 0=≢txt</code>
<code> [21]      txt←'*'</code>
<code> [22]  :EndIf</code>
<code> [23]  :If '*'∊name←txt</code>
<code> [24]      ind←⍸(⎕C name~'*'){⍺∘≡¨⎕C(≢⍺)↑¨⍵}snippetNames</code>
<code> [25]      :If 0=≢ind</code>
<code class="emphasize">→[26]          msg←'No match found' ⋄ name←'' ⋄ →0</code>
<code> [27]      :EndIf</code>
<code> [28]      :If 1=≢ind</code>
<code class="emphasize">→[29]          name←ind⊃snippetNames</code>
<code> [30]      :Else</code>
<code> [31]          list2←1↓↓bool{(1,(¯1+≢⍵)⍴⍺)⌿⍵}sourceFile List_ ns</code>
<code> [32]          ind2←('Select snippet ',caption)CommTools.Select list2</code>
<code> [33]          :If 0=≢ind2</code>
<code class="emphasize">→[34]              name←''</code>
<code class="emphasize">→[35]              msg←'Cancelled by user'</code>
<code> [36]          :Else</code>
<code> [37]              ind←ind[ind2]</code>
<code> [38]              name←ind⊃snippetNames</code>
<code> [39]          :EndIf</code>
<code> [40]      :EndIf</code>
<code> [41]  :Else</code>
<code> [42]      ind←⍸(⎕C snippetNames)≡¨⊂⎕C name</code>
<code> [43]      :If 0=≢ind</code>
<code class="emphasize">→[44]          msg←'No snippet found'</code>
<code class="emphasize">→[45]          name←''</code>
<code> [46]      :Else</code>
<code> [47]          name←ind⊃snippetNames</code>
<code> [48]      :EndIf</code>
<code> [49]  :EndIf</code>
</div>
<code class="header" id="listing_27">⎕SE._tatin.aplteam_Snippets_0_5_2.Run &mdash; 78%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  r←sourceFile Run(Cmd Args)</code>
<code> [1]   r←0 0⍴''</code>
<code> [2]   :Select ⎕C Cmd</code>
<code> [3]   :Case ⎕C'List'</code>
<code> [4]       r←sourceFile List_ Args</code>
<code> [5]   :Case ⎕C'Edit'</code>
<code class="emphasize">→[6]       r←sourceFile Edit_ Args</code>
<code> [7]   :Case ⎕C'Copy'</code>
<code> [8]       r←sourceFile Copy_ Args</code>
<code> [9]   :Case ⎕C'Fix'</code>
<code> [10]      r←sourceFile Fix_ Args</code>
<code> [11]  :Case ⎕C'Save'</code>
<code class="emphasize">→[12]      r←Save_ Args</code>
<code> [13]  :Case ⎕C'Delete'</code>
<code class="emphasize">→[14]      r←sourceFile Delete_ Args</code>
<code> [15]  :Case ⎕C'Compare'</code>
<code class="emphasize">→[16]      r←Compare_ Args</code>
<code> [17]  :Case ⎕C'Show'</code>
<code> [18]      r←sourceFile Show_ Args</code>
<code> [19]  :Case ⎕C'Help'</code>
<code> [20]      r←Help_ Args</code>
<code> [21]  :Case ⎕C'Version'</code>
<code> [22]      r←Version_</code>
<code> [23]  :Else</code>
<code class="emphasize">→[24]      ∘∘∘ ⍝ Huh?!</code>
<code> [25]  :EndSelect</code>
</div>
<code class="header" id="listing_28">⎕SE._tatin.aplteam_Snippets_0_5_2.Copy_ &mdash; 83%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  msg←sourceFile Copy_ ns</code>
<code> [1]   :If 'Win'≡3↑1⊃'#'⎕WG'APLVersion'</code>
<code> [2]       name←''ns.Switch ns._1</code>
<code> [3]       (filenames snippetNames ind name msg)←CollectSnippetInfo'to copy to clipboard'name sourceFile</code>
<code> [4]       :If 0=≢msg</code>
<code> [5]           success←counter←0</code>
<code> [6]           max←5</code>
<code> [7]           :Repeat</code>
<code> [8]               :Trap 0 ⍝ Yes, this fails occasionally under Windows for no reason at all</code>
<code> [9]                   'cl'⎕WC'Clipboard'</code>
<code> [10]                  cl{11::⍺{_←⎕DL 0.5 ⋄ ⍺ ∇ ⍵}⍵ ⋄ ⍺.Text←⍵}GetCodeFromFile ind⊃filenames</code>
<code> [11]                  success←1</code>
<code> [12]              :Else</code>
<code class="emphasize">→[13]                  ⎕DL 0.01</code>
<code class="emphasize">→[14]                  counter+←1</code>
<code> [15]              :EndTrap</code>
<code> [16]          :Until success∨counter&gt;max</code>
<code> [17]          qdmx←⎕DMX</code>
<code> [18]          ('Could not load &lt;',(⊃,/1 ⎕NPARTS ind⊃filenames),'&gt; : ',qdmx.Message)Assert success</code>
<code> [19]          msg←'Copied to the clipboard: ',ind⊃snippetNames</code>
<code> [20]      :EndIf</code>
<code> [21]  :Else</code>
<code class="emphasize">→[22]      msg←'This command is only available on Windows'</code>
<code> [23]  :EndIf</code>
</div>
<code class="header" id="listing_29">⎕SE._tatin.aplteam_Snippets_0_5_2.List_ &mdash; 91%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  r←sourceFile List_ ns</code>
<code> [1]   r←'No snippets found'</code>
<code> [2]   folder←GetHomeFolder sourceFile,'/..'</code>
<code> [3]   list←FilesAndDirs.ListFiles folder</code>
<code> [4]   full←ns.Switch'full'</code>
<code> [5]   :If 0&lt;≢list</code>
<code> [6]       list2←{⊃,/1↓⎕NPARTS ⍵}¨list</code>
<code> [7]       name←ns._1</code>
<code> [8]       :If 0≢name</code>
<code> [9]           bool←name{(⎕C ⍺)∘≡¨⎕C(≢⍺)↑¨⍵}list2</code>
<code> [10]          (list list2)←bool∘/¨list list2</code>
<code> [11]      :EndIf</code>
<code> [12]  :AndIf 0&lt;≢list</code>
<code> [13]      :If full</code>
<code class="emphasize">→[14]          r←list</code>
<code> [15]      :Else</code>
<code> [16]          r←list2</code>
<code> [17]      :EndIf</code>
<code> [18]      :If ns.Switch'short'</code>
<code class="emphasize">→[19]          r←⍪(⊂'*** Folder: ',folder),' ',¨r</code>
<code> [20]      :Else</code>
<code> [21]          comments←GetComment¨list</code>
<code> [22]          :If 0&lt;≢ind←⍸{'.code'≡3⊃⎕NPARTS ⍵}¨list</code>
<code> [23]              comments[ind]←∊∘GetCodeFromFile¨list[ind]</code>
<code> [24]          :EndIf</code>
<code> [25]          r←r,[1.5]comments</code>
<code> [26]          r←'*** Folder:'folder⍪r</code>
<code> [27]      :EndIf</code>
<code> [28]      r←⍕r</code>
<code> [29]      r←CutWidth r</code>
<code> [30]  :EndIf</code>
</div>
<code class="header" id="listing_30">⎕SE._tatin.aplteam_Snippets_0_5_2.Assert &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> Assert←{⍺←'' ⋄ (,1)≡,⍵:r←1 ⋄ ⍺ ⎕SIGNAL 1↓(⊃∊⍵),11}</code>
</div>
<code class="header" id="listing_31">⎕SE._tatin.aplteam_Snippets_0_5_2.GetCodeFromFile &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  body←GetCodeFromFile filename</code>
<code> [1]   body←⊃FilesAndDirs.NGET filename 1</code>
<code> [2]   :If '.apla'≡3⊃⎕NPARTS filename</code>
<code> [3]       body←⎕SE.Dyalog.Array.Deserialise body</code>
<code> [4]   :ElseIf 1=≢body</code>
<code> [5]   :AndIf (⊂3⊃⎕NPARTS filename)∊'.aplf' '.aplo' '.code'</code>
<code> [6]       buff←{⍵{⍵\⍵/⍺}{~⍵∨≠\⍵}''''=⍵}⊃body ⍝ Wipe out anything quoted</code>
<code> [7]       body←⊂(¯1+buff⍳'⍝')↑⊃body</code>
<code> [8]   :EndIf</code>
<code> [9]   body←↓APLTreeUtils2.DLB↑body</code>
<code> [10] ⍝Done</code>
</div>
<code class="header" id="listing_32">⎕SE._tatin.aplteam_Snippets_0_5_2.GetComment &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  r←GetComment filename</code>
<code> [1]   body←⊃FilesAndDirs.NGET filename 1</code>
<code> [2]   :If 1=≢body</code>
<code> [3]   :AndIf (⊂3⊃⎕NPARTS filename)∊'.aplf' '.aplo' '.code'</code>
<code> [4]       buff←{⍵{⍵\⍵/⍺}{~⍵∨≠\⍵}''''=⍵}⊃body ⍝ Wipe out anything quoted</code>
<code> [5]       r←APLTreeUtils2.DLB(buff⍳'⍝')↓⊃body</code>
<code> [6]   :Else</code>
<code> [7]       body←APLTreeUtils2.DLB¨{(+/∧\';'=⊃¨⍵)↓⍵}1↓body</code>
<code> [8]       :If '⍝'=⊃⊃body</code>
<code> [9]           r←APLTreeUtils2.DLB 1↓⊃body</code>
<code> [10]      :Else</code>
<code> [11]          r←''</code>
<code> [12]      :EndIf</code>
<code> [13]  :EndIf</code>
</div>
<code class="header" id="listing_33">⎕SE._tatin.aplteam_Snippets_0_5_2.GetHomeFolder &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> folder←GetHomeFolder parentFolder</code>
<code> [1]  folder←parentFolder,'/.snippets/'</code>
<code> [2]  'Create!'FilesAndDirs.CheckPath folder</code>
</div>
<code class="header" id="listing_34">⎕SE._tatin.aplteam_Snippets_0_5_2.GetNameFromBody &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> name←GetNameFromBody body</code>
<code> [1]  :If ∨/':class' ':namespace'{⍺≡(≢⍺)↑⍵}¨⊂⎕C' '~⍨⊃body</code>
<code> [2]      name←{⍵↑⍨¯1+⍵⍳' '}{⍵↓⍨+⍵⍳' '}APLTreeUtils2.DLB⊃body</code>
<code> [3]  :Else</code>
<code> [4]      name←⊃(⎕NS'').{' '≠1↑0⍴∊⎕FX ⍵: ⋄ ' '~⍨¨↓⎕NL⍳16}body</code>
<code> [5]  :EndIf</code>
</div>
<code class="header" id="listing_35">⎕SE._tatin.aplteam_Snippets_0_5_2.Help_ &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> r←Help_</code>
<code> [1]  r←0 0⍴''</code>
<code> [2]  ⎕SE.ADOC.Browse ⎕THIS</code>
</div>
<code class="header" id="listing_36">⎕SE._tatin.aplteam_Snippets_0_5_2.List &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  r←List</code>
<code> [1]   r←⍬</code>
<code> [2]  </code>
<code> [3]   c←⎕NS''</code>
<code> [4]   c.Name←'List'</code>
<code> [5]   c.Desc←'List all saved snippets'</code>
<code> [6]   c.Group←'Snippets'</code>
<code> [7]   c.Parse←'1s -short -full'</code>
<code> [8]   r,←c</code>
<code> [9]  </code>
<code> [10]  c←⎕NS''</code>
<code> [11]  c.Name←'Edit'</code>
<code> [12]  c.Desc←'Edit a snippet'</code>
<code> [13]  c.Group←'Snippets'</code>
<code> [14]  c.Parse←'1s'</code>
<code> [15]  r,←c</code>
<code> [16] </code>
<code> [17]  c←⎕NS''</code>
<code> [18]  c.Name←'Copy'</code>
<code> [19]  c.Desc←'Copy a snippet to the clipboard (Windows only)'</code>
<code> [20]  c.Group←'Snippets'</code>
<code> [21]  c.Parse←'1s'</code>
<code> [22]  r,←c</code>
<code> [23] </code>
<code> [24]  c←⎕NS''</code>
<code> [25]  c.Name←'Fix'</code>
<code> [26]  c.Desc←'Fix a snippet in the workspace'</code>
<code> [27]  c.Group←'Snippets'</code>
<code> [28]  c.Parse←'1s -target='</code>
<code> [29]  r,←c</code>
<code> [30] </code>
<code> [31]  c←⎕NS''</code>
<code> [32]  c.Name←'Save'</code>
<code> [33]  c.Desc←'Save a function or operator or script or a piece of code as a snippet'</code>
<code> [34]  c.Group←'Snippets'</code>
<code> [35]  c.Parse←'1s -name='</code>
<code> [36]  r,←c</code>
<code> [37] </code>
<code> [38]  c←⎕NS''</code>
<code> [39]  c.Name←'Delete'</code>
<code> [40]  c.Desc←'Delete a snippet'</code>
<code> [41]  c.Group←'Snippets'</code>
<code> [42]  c.Parse←'1s -force'</code>
<code> [43]  r,←c</code>
<code> [44] </code>
<code> [45]  c←⎕NS''</code>
<code> [46]  c.Name←'Show'</code>
<code> [47]  c.Desc←'Show a snippet with ⎕ED'</code>
<code> [48]  c.Group←'Snippets'</code>
<code> [49]  c.Parse←'1s -session'</code>
<code> [50]  r,←c</code>
<code> [51] </code>
<code> [52]  c←⎕NS''</code>
<code> [53]  c.Name←'Compare'</code>
<code> [54]  c.Desc←'Compare an object in the workspace with a saved snippet'</code>
<code> [55]  c.Group←'Snippets'</code>
<code> [56]  c.Parse←'1-2'</code>
<code> [57]  r,←c</code>
<code> [58] </code>
<code> [59]  c←⎕NS''</code>
<code> [60]  c.Name←'Help'</code>
<code> [61]  c.Desc←'Provide a help page explaining the principles'</code>
<code> [62]  c.Group←'Snippets'</code>
<code> [63]  c.Parse←''</code>
<code> [64]  r,←c</code>
<code> [65] </code>
<code> [66]  c←⎕NS''</code>
<code> [67]  c.Name←'Version'</code>
<code> [68]  c.Desc←'Return the version number'</code>
<code> [69]  c.Group←'Snippets'</code>
<code> [70]  c.Parse←'0'</code>
<code> [71]  r,←c</code>
</div>
<code class="header" id="listing_37">⎕SE._tatin.aplteam_Snippets_0_5_2.Version_ &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> r←Version_</code>
<code> [1] ⍝ See also `History`</code>
<code> [2]  r←'0.5.2+100'</code>
</div>
<div id="footer">
<hr>
<p>Created by "CodeCoverage" version 0.10.6+52 from 2024-03-13</p>
</div>

</body>
</html>
